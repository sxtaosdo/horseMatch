var AssetAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?i(s):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var BaseGameEntity=function(){function e(){this.sid=e.index+"",e.index++}var t=(__define,e);t.prototype;return e.index=0,e}();egret.registerClass(BaseGameEntity,"BaseGameEntity");var EntityManager=function(){function e(){this._length=0,this._entityMap={}}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.registerEntity=function(e){this._entityMap[e.sid]=e},i.getEntityFromID=function(e){return this._entityMap[e]},i.removeEntity=function(e){var t;for(t in this._entityMap)this._entityMap[t]==e&&delete this._entityMap[t]},i.getAllEntity=function(){return this._entityMap},i.getAvailableEntity=function(e){var t,n;for(t in this._entityMap){var i=this._entityMap[t];if(i instanceof e&&null!=i&&1==i.isDestroy)return n=i}return n=this.createEntity(e)},i.createEntity=function(e){var t=new e;return t.isDestroy=!1,this.registerEntity(t),this._length++,t},t(i,"length",function(){return this._length}),e}();egret.registerClass(EntityManager,"EntityManager");var BaseMovingEntity=function(e){function t(){e.call(this),this._speed=0,this.hitBox=new egret.Rectangle}__extends(t,e);var n=__define,i=t,s=i.prototype;return n(s,"position",function(){return this._position},function(e){this._position=e,this.displayObject.x=this.position.x,this.displayObject.y=this.position.y}),n(s,"speed",function(){return this._speed},function(e){this._speed=e}),n(s,"rotation",function(){return this._rotation},function(e){this._rotation=e,this.displayObject.rotation=this._rotation,this.setSpeedXY()}),s.setSpeedXY=function(){if(this._rotation&&this.speed>0){var e=this.rotation/57;this.speedX=this.speed*Math.cos(e),this.speedY=this.speed*Math.sin(e)}},t}(BaseGameEntity);egret.registerClass(BaseMovingEntity,"BaseMovingEntity");var HorseEnityStateIdel=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.self=e,this.self.currentX=GameWorld.LEFT_LINE,this.self.getDisplayObject().x=GameWorld.LEFT_LINE,this.self.changeAnimation(AnimationType.IDEL)},i.execute=function(e){},i.exit=function(e){},e}();egret.registerClass(HorseEnityStateIdel,"HorseEnityStateIdel",["IState","IBase"]);var HorseEnityStateSeek=function(){function e(){this.client=ClientModel.instance}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.self=e,this.self.changeAnimation(AnimationType.RUN)},i.execute=function(e){this.self=e;var t=RandomUtil.randNumber(1,25);this.self.speed=t,t>this.client.maxSpeed&&(this.client.maxSpeed=t),this.self.currentX+=t,this.self.currentX>GameWorld.RIGHT_LINE+ClientModel.instance.roadPastLength&&(this.self.currentX<GameWorld.DEADLINE_LENGTH?ClientModel.instance.roadPastLength=this.self.currentX-GameWorld.RIGHT_LINE:(e.getFSM().ChangeState(HorseEnityStateEnd.instance),GameDispatcher.send(BaseEvent.REACH_END_LINE))),e.getDisplayObject().x=this.self.currentX-ClientModel.instance.roadPastLength},i.exit=function(e){},e}();egret.registerClass(HorseEnityStateSeek,"HorseEnityStateSeek",["IState","IBase"]);var HorseEnityStateEnd=function(){function e(){this.client=ClientModel.instance}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){var t=this;this.self=e,egret.Tween.get(this).wait(1e3/30*100).call(function(){t.self.displayObject.frameRate=0,egret.Tween.get(t.self.displayObject).wait(200).to({frameRate:30},5e3)})},i.execute=function(e){this.self=e;var t=RandomUtil.randNumber(1,10);this.self.speed=t,t>this.client.maxSpeed&&(this.client.maxSpeed=t),this.self.currentX+=t,e.getDisplayObject().x=this.self.currentX-ClientModel.instance.roadPastLength},i.exit=function(e){},e}();egret.registerClass(HorseEnityStateEnd,"HorseEnityStateEnd",["IState","IBase"]);var HorseEnityStateStuck=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.self=e},i.execute=function(e){this.self=e},i.exit=function(e){},e}();egret.registerClass(HorseEnityStateStuck,"HorseEnityStateStuck",["IState","IBase"]);var HorseEnityStatePass=function(){function e(){}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.onMessage=function(e,t){return!1},i.enter=function(e){this.self=e,this.self.changeAnimation(AnimationType.JUMP)},i.execute=function(e){},i.exit=function(e){},e}();egret.registerClass(HorseEnityStatePass,"HorseEnityStatePass",["IState","IBase"]);var StateMachine=function(){function e(e){this.m_pOwner=e,this.m_pCurrentState=null,this.m_pPreviousState=null,this.m_pGlobalState=null}var t=__define,n=e,i=n.prototype;return i.SetCurrentState=function(e){this.m_pCurrentState=e},i.SetPreviousState=function(e){this.m_pPreviousState=e},i.SetGlobalState=function(e){this.m_pGlobalState=e},i.Update=function(){null!=this.m_pGlobalState&&this.m_pGlobalState.execute(this.m_pOwner),null!=this.m_pCurrentState&&this.m_pCurrentState.execute(this.m_pOwner)},i.ChangeState=function(e){null==this.m_pCurrentState?(this.m_pCurrentState=e,this.m_pCurrentState.enter(this.m_pOwner)):null!=e?(this.m_pPreviousState=this.m_pCurrentState,this.m_pCurrentState.exit(this.m_pOwner),this.m_pCurrentState=e,this.m_pCurrentState.enter(this.m_pOwner)):console.error("pNewState:"+e)},i.HandleMessage=function(e){return this.m_pCurrentState&&this.m_pCurrentState.onMessage(this.m_pOwner,e)?!0:this.m_pGlobalState&&this.m_pGlobalState.onMessage(this.m_pOwner,e)?!0:!1},i.RevertToPreviousState=function(){this.ChangeState(this.m_pPreviousState)},i.isInState=function(e){return this.m_pCurrentState instanceof e?!0:!1},t(i,"CurrentState",function(){return this.m_pCurrentState}),t(i,"GlobalState",function(){return this.m_pGlobalState}),t(i,"PreviousState",function(){return this.m_pPreviousState}),i.GetNameOfCurrentState=function(){},e}();egret.registerClass(StateMachine,"StateMachine");var MessageDispatcher=function(){function e(){this.SEND_MSG_IMMEDIATELY=0,this.NO_ADDITIONAL_INFO=0,this.PriorityQ=new TreeSet,this.showList=new Array}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.Discharge=function(e,t){this.showList.push(t),!e.handleMessage(t)},t(i,"showListData",function(){return this.showList}),i.DispatchMessage=function(e,t,n,i,s){void 0===s&&(s=null);var r=(EntityManager.instance.getEntityFromID(t),EntityManager.instance.getEntityFromID(n));if(null==r)return void console.warn("\nWarning! No Receiver with ID of "+n+" found");var a=new Telegram(0,t,n,i,s);0>=e?this.Discharge(r,a):(a.DispatchTime=egret.getTimer(),this.PriorityQ.add(a))},i.DispatchDelayedMessages=function(){for(;!this.PriorityQ.isEmpty&&this.PriorityQ.first.DispatchTime<=egret.getTimer()&&this.PriorityQ.first.DispatchTime>0;){var e=this.PriorityQ.first,t=EntityManager.instance.getEntityFromID(e.Receiver);this.Discharge(t,e),this.PriorityQ.remove(this.PriorityQ.first)}},i.DispatchSimpleMessage=function(e,t){var n=e,i=t;if(null==i)return void console.warn("\nWarning! No Receiver with ID of "+t+" found");var s=new Telegram(0,n.sid,t.sid,0,null);this.Discharge(i,s)},e}();egret.registerClass(MessageDispatcher,"MessageDispatcher");var MessageType=function(){function e(){}var t=(__define,e);t.prototype;return e}();egret.registerClass(MessageType,"MessageType");var Telegram=function(){function e(e,t,n,i,s){void 0===s&&(s=null),this.SmallestDelay=.25,this.Sender=t,this.Receiver=n,this.Msg=i,this.DispatchTime=e,this.time=egret.getTimer()}var t=__define,n=e,i=n.prototype;return i.ExtraInfo=function(){},t(i,"sortSerial",function(){return this.DispatchTime}),e}();egret.registerClass(Telegram,"Telegram",["ICompositor"]);var TreeSet=function(){function e(){this.list=new Array}var t=__define,n=e,i=n.prototype;return i.add=function(e){return this.list.indexOf(e)>-1?!1:(this.addElement(e),!0)},t(i,"isEmpty",function(){return this.list.length>0?!1:!0}),t(i,"size",function(){return this.list.length}),i.SortedSet=function(){this.list.sort(this.compareFunction)},i.compareFunction=function(e,t){return e.sortSerial>t.sortSerial?1:e.sortSerial<t.sortSerial?-1:0},i.remove=function(e){this.list.splice(this.list.indexOf(e),1),this.SortedSet()},t(i,"first",function(){return this.list[0]}),t(i,"last",function(){return this.list[this.list.length-1]}),i.addElement=function(e){this.list.push(e),this.SortedSet()},e}();egret.registerClass(TreeSet,"TreeSet");var Vector2Ds=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}var t=(__define,e),n=t.prototype;return n.zero=function(){this.x=0,this.y=0},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.lengthSq=function(){return this.x*this.x+this.y*this.y},n.dot=function(e){return this.x*e.x+this.y*e.y},n.sign=function(t){return this.y*t.x>this.x*t.y?e.anticlockwise:e.clockwise},n.perp=function(){return new e(-this.y,this.x)},n.distance=function(e){var t=e.y-this.y,n=e.x-this.x;return Math.sqrt(t*t+n*n)},n.distanceSq=function(e){var t=e.y-this.y,n=e.x-this.x;return t*t+n*n},n.truncate=function(e){this.length()>e&&(this.normalize(),Vector2DOperator.vectorByNum(this,e))},n.reflect=function(e){return Vector2DOperator.operatorAdd(this,Vector2DOperator.numByVector(2*this.dot(e),e.getReverse()))},n.getReverse=function(){return new e(-this.x,-this.y)},n.normalize=function(){var e=this.length();e>Vector2DOperator.epsilon&&(this.x/=e,this.y/=e)},n.vec2DNormalize=function(e){var t=e,n=t.length();return n>Vector2DOperator.epsilon&&(t.x/=n,t.y/=n),t},n.vec2DDistance=function(e,t){var n=t.y-e.y,i=t.x-e.x;return Math.sqrt(n*n+i*i)},n.vec2DDistanceSq=function(e,t){var n=t.y-e.y,i=t.x-e.x;return n*n+i*i},n.vec2DLength=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.vec2DLengthSq=function(e){return e.x*e.x+e.y*e.y},n.POINTStoVector=function(t){return new e(t.x,t.y)},n.POINTtoVector=function(t){return new e(t.x,t.y)},n.vectorToPOINTS=function(e){var t;return t.x=e.x,t.y=e.y,t},n.vectorToPOINT=function(e){var t;return t.x=e.x,t.y=e.y,t},n.wrapAround=function(e,t,n){e.x>t&&(e.x=0),e.x<0&&(e.x=t),e.y<0&&(e.y=n),e.y>n&&(e.y=0)},n.notInsideRegion=function(e,t,n){return e.x<t.x||e.x>n.x||e.y<t.y||e.y>n.y},n.insideRegion3=function(e,t,n){return!(e.x<t.x||e.x>n.x||e.y<t.y||e.y>n.y)},n.insideRegion5=function(e,t,n,i,s){return!(e.x<t||e.x>i||e.y<n||e.y>s)},n.isSecondInFOVOfFirst=function(e,t,n,i){var s=this.vec2DNormalize(Vector2DOperator.operatorMinus(n,e));return t.dot(s)>=Math.cos(i/2)},n.clone=function(){return new e(this.x,this.y)},e.clockwise=1,e.anticlockwise=-1,e}();egret.registerClass(Vector2Ds,"Vector2Ds");var Vector2DOperator=function(){function e(){}var t=__define,n=e;n.prototype;return e.operatorAdd=function(e,t){return e.x+=t.x,e.y+=t.y,e},e.operatorMinus=function(e,t){return e.x-=t.x,e.y-=t.y,e},t(e,"epsilon",function(){var e=Number.MAX_VALUE-1,t=Math.abs(1+Number.MIN_VALUE);return Math.max(e,t)}),e.numByVector=function(e,t){return t.x=t.x*e,t.y=t.y*e,t},e.vectorByNum=function(e,t){return e.x=e.x*t,e.y=e.y*t,e},e}();egret.registerClass(Vector2DOperator,"Vector2DOperator");var ClientModel=function(){function e(){this._resLoaded=!1,this._language="zh_CN",this.maxSpeed=0,this.user=UserModel.instance,this.moneyType="0",this._phaseList=new Array,this._horseList=new Array,this._history=new Array,this._gameInfo=new GameInfoVo,this._betInfo=new Object}var t=__define,n=e,i=n.prototype;return t(i,"isSimple",function(){return egret.Capabilities.isMobile&&"web"==egret.Capabilities.runtimeType||InterfaceManager.instance.isWeiXin?!0:!1}),t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.parseParams=function(){if(console.log("当前系统："+egret.Capabilities.os),console.log("移动设备："+egret.Capabilities.isMobile),console.log("系统语言："+egret.Capabilities.language),console.log("运行环境："+egret.Capabilities.runtimeType),console.log("龙骨version："+dragonBones.DragonBones.VERSION),egret.Capabilities.isMobile&&console.log("native support版本："+egret.Capabilities.supportVersion),egret.Capabilities.runtimeType==egret.RuntimeType.WEB){var e=window.document.location.href.toString();console.log("浏览器地址："+e),UserModel.instance.userName=decodeURI(egret.getOption("userName").toString()),UserModel.instance.roleName=decodeURI(egret.getOption("roleName")),UserModel.instance.nickName=decodeURI(egret.getOption("nickName")),UserModel.instance.token=egret.getOption("lztoken")}egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},i.changeGameState=function(e){this._gameState!=e&&(this._gameState=e,GameDispatcher.send(GameEvent.GAME_STATE_EVENT))},t(i,"gameState",function(){return this._gameState}),t(i,"moneyType",function(){return this._moneyType},function(e){this._moneyType=e}),t(i,"language",function(){return this._language},function(e){this._language=e}),t(i,"betInfo",function(){return this._betInfo}),t(i,"lastBetInfo",function(){return this._lastBetInfo}),i.setBetInfo=function(e,t){var n=new MatchInfoVo(t);this._lastBetInfo=n,this._betInfo[e]=n,GameDispatcher.send(BaseEvent.BET_INFO_CHANGE)},t(i,"gameInfoVo",function(){return this._gameInfo}),t(i,"gameInfo",void 0,function(e){this._gameInfo.setData(e),this.user.money=this._gameInfo.acctAmount,console.log("money:"+this._gameInfo.acctAmount),GameDispatcher.send(BaseEvent.GAME_STATE_INFO)}),t(i,"window",function(){return this._currentWin}),i.openWindow=function(t,n){t==e.instance._currentWin?e.instance._currentWin=null:e.instance._currentWin=t,GameDispatcher.send(GameEvent.WINDOW_EVENT),WindowManager.instance.open(t,n)},i.openAlert=function(e,t,n,i){var s="";switch(e){case 1:s=LanguageConfig.instance.getLanguage("您的余额不足，请前往充值"),t=InterfaceManager.instance.recharge;break;case 2:s=LanguageConfig.instance.getLanguage("您已断开连接，请刷新"),t=InterfaceManager.instance.closeApp;break;case 3:s=LanguageConfig.instance.getLanguage("您的游戏卷不足");break;default:s=e}this.openWindow(Alert,{text:s,okFun:t,cancelFun:n,closeFun:i})},i.onConn=function(){GameDispatcher.send(GameEvent.GAME_NET_CONN)},i.onAssetsComplete=function(e){this._resLoaded=!0,GameDispatcher.send(GameEvent.ASSETS_COMPLETE_EVENT)},i.resLoaded=function(){return this._resLoaded},i.onLiveTick=function(e){},i.initGameSprite=function(e){for(var t=0;5>t;t++){var n=new Array,i=new ObstacleVo((new md5).hex_md5(e+t+"obstacle"));n.push(i);var s=new BufferVo((new md5).hex_md5(e+t+"buffer"));n.push(s),this._phaseList.push(n)}return this._phaseList},t(i,"phaseList",function(){return this._phaseList}),t(i,"horseList",function(){return this._horseList}),t(i,"roadPastLength",function(){return this._roadPastLength},function(e){this._roadPastLength!=e&&(this._roadPastLength=e)}),i.setHistory=function(e){for(var t=this;this._history.length>0;)this._history.pop();e.drawInfo.forEach(function(e){t._history.push(new HistoryVo(e))}),GameDispatcher.send(BaseEvent.WINDOW_HISTORY)},t(i,"history",function(){return this._history}),e.heartbeat_interval=1e4,e}();egret.registerClass(ClientModel,"ClientModel");var ConfigModel=function(){function e(){this._version="",this._debug=!1,this._isShowLogin=!1,this._showTest=!1,this._horseList=new Array}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.parse=function(e){this._version=e.version,this._url=e.url,this._prepareTime=e.prepareTime,this._showTest=e.showTest,this._betTime=e.betTime,this._nextTime=e.nextTime,console.log("配置文件:"+this._version),e.debug&&(this._debug=e.debug,this._debug&&(this._isShowLogin=!0),console.log("debug模式:"+this._debug)),this.horseData(RES.getRes("horse_json")),ClientModel.instance.prepareTime=this._prepareTime,ClientModel.instance.betTime=this._betTime,ClientModel.instance.nextTime=this._nextTime,GameDispatcher.send(GameEvent.CONFIG_INIT_COMPLETE_EVENT)},i.horseData=function(e){var t;for(t in e){var n=new HorseVo;n.analysis(e[t]),this._horseList.push(n)}},t(i,"version",function(){return this._version}),t(i,"url",function(){return"http://ali.game.com:8080"}),t(i,"debug",function(){return this._debug}),t(i,"isShowLogin",function(){return this._isShowLogin}),t(i,"showTest",function(){return this._showTest}),t(i,"betTime",function(){return this._betTime}),t(i,"prepareTime",function(){return this._prepareTime}),t(i,"nextTime",function(){return this._nextTime}),t(i,"horseList",function(){return this._horseList}),e}();egret.registerClass(ConfigModel,"ConfigModel");var AnimationType=function(){function e(){}var t=(__define,e);t.prototype;return e.IDEL="daiji",e.RUN="pao",e.JUMP="kualan",e.DROWN="luoshui",e.FALL="zhanggan",e}();egret.registerClass(AnimationType,"AnimationType");var GameStateDef=function(){function e(){}var t=(__define,e);t.prototype;return e.GAME_STATE_ACCOUNT_NULL=0,e.GAME_STATE_LOTTERY=100,e.GAME_STATE_LOTTERY_COMMON=200,e.GAME_STATE_LOTTERY_FREE=250,e.GAME_STATE_JP=300,e.TYPE_COMMON=0,e.TYPE_FREE=1,e}();egret.registerClass(GameStateDef,"GameStateDef");var StateDef=function(){function e(){}var t=(__define,e);t.prototype;return e.IDEL=0,e.ACTIVITY=1,e}();egret.registerClass(StateDef,"StateDef");var LanguageConfig=function(){function e(){this.dic=new Object}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.parse=function(e){var t,n,i=e.split("\r\n");for(t in i)""!=i[t]&&(n=i[t].split("	"),this.dic[n[0]]=n[1]);GameDispatcher.send(GameEvent.LANGUAGE_INIT_COMPLETE_EVENT)},i.getLanguage=function(e){return null!=this.dic[e]?this.dic[e]:e},e}();egret.registerClass(LanguageConfig,"LanguageConfig");var UserModel=function(){function e(){this._userName="",this._roleName="",this._nickName="",this._money=0,this._token="",this._isAnteVoChange=!1}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),t(i,"token",function(){return this._token},function(e){this._token=e,this._token="080110F1AD83BF051A013022F00398533BCCCA089DE3E277E0EA4BE17F6E303A3F3DCA30E5C85AE2FAB93911B8DC46E0248968A044F2AA4C9DF736EC5F645D529598C06AD48AEF4D9C4B512DF7649C2B31F9C196AAFB4ECE9F08E232146CD487C6E82F5AB4444B0903CD2C34DB4DED3A61CCD080F3FE745216CB4CF55AA8BD63FB8C085D85B4DA03425E1E29EAA3D33BE341169EF1F77596C501631FA3D80A12E0F398DD80F677EB86BB80D71DE421EB7D9C3FE72125EF4D9C4B512DF7649C2B31F9C196AAFB4ECE9F08E232146C49A524253034A802EE2A9C7871C5DC408CB3FFB85E62452BF5DC95A4ED9117299B03776C99DB5002CA5DA5E0C98DC816603F284EC6997DB085C379A0B95CEC797711F4832A563AA5B5C7943D133D1DAA25A58E612EF9379BB327D9FE803D95883517A8F426DEE45297364AAD5CE5F8C2AFC3E0E341017F32E5AAEAF4AECB3703AF09DBE6E93E5AA40177C9BA103977E2BB3B90ACDEB2839296BF21E9DB9849F4425AA559598F69B7DE01B69D5E2E67746DEA5E6E6B07776DCA59624F738C7B15F4E47050ED29FB8DBF758B13FE8D7ACDFA95A22F98B7B88C67711985227B86D83D73754A0F2C785CDBBED3813B0DF31DFD7625D357831B143D5F6E10EB3F4EC26DFEA04041D29004546D1BF246177ABFFB097EBB2DF59BA708318256CF54CAB4638A65F56DFB2351602E256056A0F13D"}),t(i,"userName",function(){return this._userName},function(e){this._userName=e}),t(i,"roleName",function(){return this._roleName},function(e){this._roleName=e}),t(i,"nickName",function(){return this._nickName},function(e){this._nickName=e}),t(i,"JSESSIONID",function(){return this._JSESSIONID},function(e){this._JSESSIONID=e}),t(i,"money",function(){return this._money},function(e){this._money=e,GameDispatcher.send(BaseEvent.USER_MOENY_CHANGE)}),i.isEnough=function(e){return this.money<e?!1:!0},e}();egret.registerClass(UserModel,"UserModel");var BufferVo=function(){function e(e){e&&this.initData(e)}var t=(__define,e),n=t.prototype;return n.initData=function(e){var t=0,n=4,i=0;i=(parseInt(e.substring(t,t+n),16)+6e4)/2,this.time=i/100,t+=n,i=(parseInt(e.substring(t,t+n),16)+6e4)/2,this.holdTime=i/100},e}();egret.registerClass(BufferVo,"BufferVo");var GameInfoVo=function(){function e(){}var t=(__define,e),n=t.prototype;return n.setData=function(e){this.acctAmount=e.acctAmount,this.cdTime=Math.floor(e.cdTime/1e3),this.drawId=e.drawId,this.leftTime=Math.floor(e.leftTime/1e3),this.rtnCode=e.rtnCode,this.rtnMsg=e.rtnMsg,this.nextDrawId=e.nextDrawId},e}();egret.registerClass(GameInfoVo,"GameInfoVo");var HistoryVo=function(){function e(e){this.matchInfoList=new Array,e&&this.setData(e)}var t=(__define,e),n=t.prototype;return n.setData=function(e){var t=this;this.id=e.drawId,e.matchInfo.forEach(function(e){t.matchInfoList.push(new MatchPlayerVo(e))})},e}();egret.registerClass(HistoryVo,"HistoryVo");var HorseVo=function(){function e(){}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.id=e.id,this.name=e.name,this.habitat=e.habitat,this.age=e.age,this.breed=e.breed,this.acceleration=e.acceleration,this.maximumSpeed=e.maximumSpeed,this.speed=e.speed,this.endurance=e.endurance,this.recovery=e.recovery,this.mcName=e.mcName},e}();egret.registerClass(HorseVo,"HorseVo");var MatchInfoVo=function(){function e(e){this.info=new GameInfoVo,this.horseInfoList=new Array,e&&this.setData(e)}var t=(__define,e),n=t.prototype;return n.setData=function(e){var t=this;this.info.setData(e),e.matchInfo.forEach(function(e){t.horseInfoList.push(new MatchPlayerVo(e))})},e}();egret.registerClass(MatchInfoVo,"MatchInfoVo");var MatchPlayerVo=function(){function e(e){this.bet=0,e&&this.analysis(e)}var t=(__define,e),n=t.prototype;return n.analysis=function(e){this.id=e.hId,this.rate=e.odds,this.state=e.state,this.rank=e.rank},e}();egret.registerClass(MatchPlayerVo,"MatchPlayerVo");var ObstacleVo=function(){function e(e){this.type=0,e&&this.initData(e)}var t=(__define,e),n=t.prototype;return n.initData=function(e){var t=0,n=4,i=0;i=(parseInt(e.substring(t,t+n),16)+6e4)/2,this.type=5e3>i?0:1,t+=n,i=(parseInt(e.substring(t,t+n),16)+6e4)/2,this.local=i/100,t+=n,i=(parseInt(e.substring(t,t+n),16)+6e4)/2,this.isPass=5e4>i?!0:!1,t+=n,i=(parseInt(e.substring(t,t+n),16)+6e4)/2,this.time=i/1e4},e}();egret.registerClass(ObstacleVo,"ObstacleVo");var BaseEvent=function(){function e(){}var t=(__define,e);t.prototype;return e.LOGIN_RESULT_EVENT="loginResultEvent",e.POOL_EVENT="poolEvent",e.REACH_END_LINE="reachEndLine",e.GAME_STATE_INFO="gameStateInfo",e.USER_MOENY_CHANGE="userMoneyChange",e.BET_INFO_CHANGE="betInfoChange",e.WINDOW_HISTORY="windowHistory",e}();egret.registerClass(BaseEvent,"BaseEvent");var GameDispatcher=function(e){function t(){e.call(this,null)}__extends(t,e);var n=__define,i=t;i.prototype;return n(t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t.send=function(e){e instanceof egret.Event?t.instance.dispatchEvent(e):(null==t.evtMap[e]&&(t.evtMap[e]=new egret.Event(e)),t.instance.dispatchEvent(t.evtMap[e]))},t.addEventListener=function(e,n,i){t.instance.addEventListener(e,n,i)},t.removeEventListener=function(e,n,i){t.instance.removeEventListener(e,n,i)},t.evtMap=new Object,t}(egret.EventDispatcher);egret.registerClass(GameDispatcher,"GameDispatcher");var GameEvent=function(){function e(){}var t=(__define,e);t.prototype;return e.GAME_NET_CONN="gameNetConn",e.GAME_STATE_EVENT="gameStateEvent",e.LOGIN_EVENT="loginEvent",e.CONFIG_INIT_COMPLETE_EVENT="configInitCompleteEvent",e.LANGUAGE_INIT_COMPLETE_EVENT="languageInitCompleteEvent",e.ASSETS_COMPLETE_EVENT="assetsCompleteEvent",e.VIRUAL_INFO_EVENT="virualInfoEvent",e.USER_MONEY_CHANGE="userMoneyChange",e.ANTELIST_CHANGE_EVENT="antelistChangeEvent",e.USER_BET_RANGE_CHANGE="userBetRrangeChange",e.USER_ANTE_CHANGE="userAnteChange",e.BET_EVENT="betEvent",e.LOTTERY_ROLL_RESULT="lotteryRollResult",e.LOTTERY_AUTO_EVENT="lotteryAutoEvent",e.AWARDE_CHANG_EVENT="awardeChangeEvent",e.JP_POOL_CHANGE_EVENT="jpPoolChangeEvent",e.WINDOW_EVENT="windowEvent",e.HELP_DATA_EVENT="helpDataEvent",e.BIGWIN_EVENT="bigWinEvent",e.BIGWIN_SELF_EVENT="bigWinSelfEvent",e.LEVEL_UP_EVENT="levelUpEvent",e}();egret.registerClass(GameEvent,"GameEvent");var GameMain=function(e){function t(){e.call(this),this.popup=WindowManager.instance,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.enter,this),GameDispatcher.addEventListener(GameEvent.ASSETS_COMPLETE_EVENT,this.onAssetsComplete,this),GameDispatcher.addEventListener(GameEvent.WINDOW_EVENT,this.onWindow,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){GameDispatcher.addEventListener(GameEvent.GAME_STATE_EVENT,this.onStateChange,this),this.setDefoult()},i.onAssetsComplete=function(){},i.onWindow=function(){null==ClientModel.instance.window?this.contains(this.popup)&&(this.removeChild(this.popup),this.popup.exit()):(this.addChild(this.popup),this.popup.enter())},i.setDefoult=function(){ClientModel.instance.parseParams(),ClientModel.instance.changeGameState(LoadingUI.instance),LoadingUI.instance.loadAssets(function(){ClientModel.instance.changeGameState(new HallView),ConnectionManager.instance.conn()},LoadingUI.assets1)},i.exit=function(){},i.execute=function(e){},i.onStateChange=function(e){var t=ClientModel.instance.gameState;this.previousState=this.currentState,null!=this.previousState&&this.previousState.exit(),this.currentState=t,this.currentState.enter(),this.addChild(this.currentState)},t}(egret.Sprite);egret.registerClass(GameMain,"GameMain",["IBase"]);var BackgroundPanel=function(e){function t(){e.call(this),this.topImageArr=new Array,this.topImageArr.push(BitMapUtil.createBitmapByName("bg_png"))}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){for(;this.topImageArr.length*this.topImageArr[0].width<2*GameWorld.GAME_WIDTH;){var t=BitMapUtil.createBitmapByName("bg_png");t.x=this.topImageArr.length*this.topImageArr[0].width,this.topImageArr.push(t)}var n=this;this.topImageArr.forEach(function(e){n.addChild(e)})},i.exit=function(){},i.execute=function(e){this.topImageArr.forEach(function(t){t.x-=e}),this.topImageArr[0].x<=-this.topImageArr[0].width&&(this.topImageArr.push(this.topImageArr.shift()),this.topImageArr[this.topImageArr.length-1].x=this.topImageArr[this.topImageArr.length-2].x+this.topImageArr[this.topImageArr.length-2].width)},t}(egret.Sprite);egret.registerClass(BackgroundPanel,"BackgroundPanel",["IBase"]);var BaseComponent=function(e){function t(t){void 0===t&&(t=!0),e.call(this),this.skinLoaded=!1,this.isCenter=!1,this.isCenter=t,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onStage,this),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onStage=function(e){this.isCenter&&this.center()},i.onSkinComplete=function(e){this.skinLoaded=!0;try{this.center(),this.initCloseBtn()}catch(t){console.log(t),ClientModel.instance.openWindow(null)}},i.center=function(){null!=this.stage&&(this.x=this.stage.stageWidth-this.width>>1,this.y=this.stage.stageHeight-this.height>>1)},i.initCloseBtn=function(){var e=this;try{this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.exit&&e.exit()},this)}catch(t){}},t}(eui.Component);egret.registerClass(BaseComponent,"BaseComponent");var BetView=function(e){function t(){var t=this;e.call(this,!1),this.selectMoney=100,this.coinList=new Array,this.betInfoList=Object(),this.horseData=new eui.ArrayCollection,ConfigModel.instance.horseList.forEach(function(e){t.horseData.addItem(e)}),this.skinName="resource/skins/BetViewSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.horseList.itemRenderer=HorseBetInfoRenderer;var n=new eui.HorizontalLayout;n.gap=3,this.horseList.layout=n,this.btn100.selected=!0},i.enter=function(e){this.skinLoaded&&(this.horseList.dataProvider=this.horseData,this.horseList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemTap,this),this.btn100.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoneyTap,this),this.btn1000.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoneyTap,this),this.btn10000.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoneyTap,this),this.revokeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onrevokeTap,this)),GameDispatcher.addEventListener(BaseEvent.BET_INFO_CHANGE,this.onBetChange,this),this.onBetChange()},i.exit=function(){this.onRemove(),this.btn100.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoneyTap,this),this.btn1000.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoneyTap,this),this.btn10000.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoneyTap,this),this.revokeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onrevokeTap,this),GameDispatcher.removeEventListener(BaseEvent.BET_INFO_CHANGE,this.onBetChange,this),this.parent&&this.parent.removeChild(this)},i.execute=function(e){this.horseData.removeAll()},i.onItemTap=function(e){if(!UserModel.instance.isEnough(this.selectMoney))return void ClientModel.instance.openAlert("RMB不足，请充值");var t=this.horseData.source[this.horseList.selectedIndex];t.math.bet+=this.selectMoney,UserModel.instance.money-=this.selectMoney,this.horseData.itemUpdated(t);var n=BitMapUtil.createBitmapByName("coin_png");switch(this.selectMoney){case 100:n.x=750,n.filters=[new egret.ColorMatrixFilter(MatrixUtils.red)];break;case 1e3:n.x=900;break;case 1e4:n.x=1050,n.filters=[new egret.ColorMatrixFilter(MatrixUtils.blue)]}n.y=570,this.addChild(n),null==this.coinList[this.horseList.selectedIndex]&&(this.coinList[this.horseList.selectedIndex]=new Array),egret.Tween.get(n).to({x:(this.coinList[this.horseList.selectedIndex].length%2==0?60:130)+RandomUtil.randNumber(0,5)+250*this.horseList.selectedIndex,y:390+-10*Math.floor(this.coinList[this.horseList.selectedIndex].length/2)},200),this.coinList[this.horseList.selectedIndex].push(n)},i.randomInfo=function(e){var t=new MatchPlayerVo;return t.bet=0,t.rate=RandomUtil.randInt(100,2e3)/100,t.state=RandomUtil.randInt(1,5),t},i.onMoneyTap=function(e){this.selectMoney=parseInt(e.currentTarget.label)},i.onrevokeTap=function(e){this.horseData.source.forEach(function(e){e.math.bet=0}),this.horseData.refresh(),this.onRemove()},i.onRemove=function(e){this.coinList.forEach(function(e){for(;e.length>0;){var t=e.pop();t.parent&&t.parent.removeChild(t)}})},i.onBetChange=function(){var e=this;if(ClientModel.instance.lastBetInfo){var t=ClientModel.instance.lastBetInfo.horseInfoList;t.forEach(function(t){e.betInfoList[t.id]=t}),this.horseData.source.forEach(function(t){t.math=e.betInfoList[t.id]}),this.horseData.refresh(),this.matchIdText.text=String(ClientModel.instance.lastBetInfo.info.drawId)}},t}(BaseComponent);egret.registerClass(BetView,"BetView",["IBase"]);var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.ON,this.game=new GameMain},i.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")
},i.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},i.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},i.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.addChild(this.game)},i.onAssetsComplete=function(){},i.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},i.onResourceProgress=function(e){"preload"==e.groupName&&LoadingUI.instance.setProgress(e.itemsLoaded,e.itemsTotal)},i.startCreateScene=function(){var e=new eui.Button;e.label="Click!",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this)},i.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t.STAGE_WIDTH=1270,t.STAGE_HEIGHT=720,t.VERSION="α0.1：160829:1528",t}(eui.UILayer);egret.registerClass(Main,"Main");var GameState;!function(e){e[e.BET_STAGE=0]="BET_STAGE",e[e.PREPARE_STAGE=1]="PREPARE_STAGE",e[e.RUN_STAGE=2]="RUN_STAGE",e[e.RESULT_STAGE=3]="RESULT_STAGE"}(GameState||(GameState={}));var RunState;!function(e){e[e.GEGIN=0]="GEGIN",e[e.SEESAW=1]="SEESAW",e[e.SPRINT=2]="SPRINT"}(RunState||(RunState={}));var GameWorld=function(e){function t(){e.call(this),this._pastlength=0,this.isBulletTime=!1,this.tempSpeed=0,this._gameState=GameState.BET_STAGE,this._runState=RunState.GEGIN,t.that=this,this.client=ClientModel.instance,this.graphics.beginFill(0,.1),this.graphics.drawRect(0,0,t.GAME_WIDTH,t.GAME_HEIGHT),this.graphics.endFill(),this.graphics.beginFill(0),this.graphics.drawRect(t.LEFT_LINE,0,5,t.GAME_HEIGHT),this.graphics.endFill(),this.graphics.beginFill(0),this.graphics.drawRect(t.RIGHT_LINE,0,5,t.GAME_HEIGHT),this.graphics.endFill(),this.topBar=new TopView(this.onTimerComplete,this),this.betView=new BetView,this.racetrack=new RacetrackPanel,this.addChildAt(this.racetrack,0),this.progress=new ProgressPanel,this.resultBiew=new ResultView}__extends(t,e);var n=__define,i=t,s=i.prototype;return n(s,"pastlength",function(){return this._pastlength},function(e){this._pastlength=e}),s.enter=function(e){for(var n=1;6>n;n++){var i=EntityManager.instance.getAvailableEntity(HorseEntity);i.setData(ConfigModel.instance.horseList[n-1]),i.getDisplayObject().y=80*n+200,this.client.horseList.push(i),this.addChild(i.getDisplayObject())}null==this.shutter&&(this.shutter=MovieclipUtils.createMc("shutter_png","shutter_json"),this.shutter.stop(),this.shutter.scaleX=this.shutter.scaleY=t.GAME_WIDTH/this.shutter.width,this.shutter.x=-50,this.shutter.y=-120),this.addChildAt(this.racetrack,0),GameDispatcher.addEventListener(BaseEvent.REACH_END_LINE,this.onReachEndLine,this),GameDispatcher.addEventListener(BaseEvent.GAME_STATE_INFO,this.onGameInfo,this),GameDispatcher.addEventListener(BaseEvent.BET_INFO_CHANGE,this.onMatchInfoChange,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),ConnectionManager.instance.sendHelper.gameInfo(),TimerManager.instance.doFrameLoop(1,function(){dragonBones.WorldClock.clock.advanceTime(-1)},this)},s.exit=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this.stage.removeEventListener(egret.Event.RESIZE,this.onResize,this),null!=this.parent&&this.parent.removeChild(this),this.betView.exit(),this.racetrack.exit(),TimerManager.instance.clearTimer(this.execute)},s.execute=function(){this.client.horseList.forEach(function(e){e.getFSM().Update()}),this.racetrack.execute(ClientModel.instance.roadPastLength),this.progress.parent&&this.progress.execute()},s.onBullertTme=function(){var e=this;this.isBulletTime&&(this.addChild(this.shutter),this.shutter.gotoAndPlay(1,1),egret.Tween.get(this).wait(1e3/30*10).call(function(){e.shutter.parent&&e.shutter.parent.removeChild(e.shutter)}).wait(5e3).call(function(){e.client.lastBetInfo.info.leftTime>ConfigModel.instance.nextTime?ConnectionManager.instance.sendHelper.drawMatch():e.changeState(GameState.RESULT_STAGE)}))},s.onTimerComplete=function(){switch(this._gameState){case GameState.BET_STAGE:this.betView.parent&&this.betView.parent.removeChild(this.betView),ConnectionManager.instance.sendHelper.drawMatch(this.client.gameInfoVo.drawId),this.changeState(GameState.PREPARE_STAGE);break;case GameState.PREPARE_STAGE:this.changeState(GameState.RUN_STAGE);break;case GameState.RUN_STAGE:break;case GameState.RESULT_STAGE:this.changeState(GameState.BET_STAGE)}},s.changeState=function(e){switch(this._gameState=e,this.topBar.enter(e),this._gameState){case GameState.BET_STAGE:this.resultBiew.exit(),this.addChildAt(this.betView,this.numChildren-1),this.betView.enter(),this.client.horseList.forEach(function(e){e.getFSM().ChangeState(HorseEnityStateIdel.instance)}),this._runState=RunState.GEGIN;break;case GameState.PREPARE_STAGE:ClientModel.instance.initGameSprite(this.client.gameInfoVo.drawId),this.addChild(this.progress);var t=0;this.client.horseList.forEach(function(e){e.setData(ClientModel.instance.phaseList[t++])}),this.betView.exit(),this.racetrack.enter(),this.progress.enter();break;case GameState.RESULT_STAGE:this.addChild(this.resultBiew),this.resultBiew.enter(),this.progress.parent&&(this.progress.parent.removeChild(this.progress),this.progress.exit()),this.racetrack.exit(),TimerManager.instance.clearTimer(this.execute);break;case GameState.RUN_STAGE:this.isBulletTime=!1,this.tempSpeed=0,ClientModel.instance.roadPastLength=0,TimerManager.instance.doFrameLoop(1,this.execute,this);var n=this;ConfigModel.instance.horseList.forEach(function(e){e.id&&n.client.horseList[e.id-1]&&(e.math&&e.math.bet>0?n.client.horseList[e.id-1].showSelect(!0):n.client.horseList[e.id-1].showSelect(!1))}),this.client.horseList.forEach(function(e){e.getFSM().ChangeState(HorseEnityStateSeek.instance)})}this.addChild(this.topBar),this.onResize()},s.onReachEndLine=function(){this.isBulletTime||(this.isBulletTime=!0,this.onBullertTme()),ClientModel.instance.maxSpeed=0},s.onAdd=function(){this.stage.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize()},s.onResize=function(e){this.stage&&(this.betView&&this.betView.parent&&(this.betView.y=this.stage.stageHeight-this.betView.height),this.racetrack&&this.racetrack.parent&&(this.racetrack.y=this.stage.stageHeight-this.racetrack.height),this.progress&&this.progress.parent&&(this.progress.y=this.stage.stageHeight-this.progress.height))},s.onGameInfo=function(e){ConnectionManager.instance.sendHelper.drawMatch(this.client.gameInfoVo.drawId)},s.onMatchInfoChange=function(){this.parseGameStateData(this.client.lastBetInfo.info)},s.parseGameStateData=function(e){e.cdTime>0?(this.client.betTime=e.cdTime,this.changeState(GameState.BET_STAGE)):e.leftTime>=30-ConfigModel.instance.prepareTime?(this.client.prepareTime=e.leftTime,this.changeState(GameState.PREPARE_STAGE)):e.leftTime<=ConfigModel.instance.nextTime?(this.client.nextTime=e.leftTime,this._gameState!=GameState.RESULT_STAGE&&this.changeState(GameState.RESULT_STAGE)):this.changeState(GameState.RUN_STAGE)},t.GAME_WIDTH=Main.STAGE_WIDTH,t.GAME_HEIGHT=Main.STAGE_HEIGHT,t.DEADLINE_LENGTH=6e3,t.LEFT_LINE=t.GAME_WIDTH/4*1,t.RIGHT_LINE=t.GAME_WIDTH/4*3,t}(egret.Sprite);egret.registerClass(GameWorld,"GameWorld",["IBase"]);var JpBarPanel=function(e){function t(){e.call(this,!1),this.touchChildren=!1,this.poolText=new egret.BitmapText,this.poolText.font=RES.getRes("hallPool_fnt"),this.poolText.width=240,this.poolText.x=50,this.poolText.y=20,this.poolText.textAlign=egret.HorizontalAlign.CENTER,this.skinName="resource/game_skins/JpBarSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.addChild(this.poolText)},i.enter=function(e){this.flash=MovieclipUtils.createMc("jpBarFlashMc_png","jpBarLightMc_json"),this.flash.gotoAndPlay(1,-1),this.flash.scaleX=this.flash.scaleY=.65,this.flash.x=100,this.flash.y=12,this.addChild(this.flash),this.mc=MovieclipUtils.createMc("jpBarLightMc_png","jpBarLightMc_json"),this.mc.gotoAndPlay(1,-1),this.mc.x=42,this.addChild(this.mc),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),GameDispatcher.addEventListener(BaseEvent.POOL_EVENT,this.changePool,this)},i.exit=function(){ClientModel.instance.openWindow(null),GameDispatcher.removeEventListener(BaseEvent.POOL_EVENT,this.changePool,this)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},i.onTap=function(){ClientModel.instance.openWindow(RankPanel)},i.changePool=function(){},t}(BaseComponent);egret.registerClass(JpBarPanel,"JpBarPanel",["IBase"]);var PlayerList=function(e){function t(){e.call(this,!1),this.skinName="resource/game_skins/RightPanelSkin.exml",this.touchChildren=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},t}(BaseComponent);egret.registerClass(PlayerList,"PlayerList",["IBase"]);var ProgressPanel=function(e){function t(){e.call(this),this.client=ClientModel.instance,this.propressBg=BitMapUtil.createBitmapByName("gameProgress_png"),this.propressBg.width=1242,this.propressBg.x=GameWorld.GAME_WIDTH-this.propressBg.width>>1,this.addChild(this.propressBg),this.y=GameWorld.GAME_HEIGHT-61,this.arrowList=new Array;for(var n=0;5>n;n++){var i=BitMapUtil.createBitmapByName("arrow"+(n+1)+"_png");i.x=t.STAR_X,this.arrowList.push(i),this.addChild(i)}}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){this.arrowList.forEach(function(e){e.x=t.STAR_X})},i.exit=function(){},i.execute=function(e){var n=this;this.client.horseList.forEach(function(e){var i=n.arrowList[e.getDataVo(HorseVo).id-1];i&&(i.x=Math.min(t.STAR_X+t.PORGRESS_WIDTH*(e.currentX-GameWorld.LEFT_LINE)/(GameWorld.DEADLINE_LENGTH-GameWorld.LEFT_LINE),t.PORGRESS_WIDTH+t.STAR_X))})},t.STAR_X=23,t.PORGRESS_WIDTH=1195,t}(egret.Sprite);egret.registerClass(ProgressPanel,"ProgressPanel",["IBase"]);var RacetrackPanel=function(e){function t(){e.call(this),this.y=300,this.racetrackArr=new Array;for(var t=0;5>t;t++)this.racetrackArr.push(new egret.Sprite);this.bgImage=new BackgroundPanel,this.addChildAt(this.bgImage,0),this.bg=new egret.Sprite,this.bg.graphics.beginFill(0,.7),this.bg.graphics.drawRect(0,50,GameWorld.GAME_WIDTH,5),this.bg.graphics.drawRect(0,150,GameWorld.GAME_WIDTH,5),this.bg.graphics.drawRect(0,250,GameWorld.GAME_WIDTH,5),this.bg.graphics.drawRect(0,350,GameWorld.GAME_WIDTH,5),this.addChild(this.bg)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){this.bgImage.enter()},i.exit=function(){this.clearnRacetrack(),this.bgImage.exit()},i.execute=function(e){this.racetrackArr.forEach(function(t){t.x=-e}),this.bgImage.execute(ClientModel.instance.maxSpeed)},i.clearnRacetrack=function(){this.racetrackArr.forEach(function(e){for(;e.numChildren>0;)e.removeChild(e.getChildAt(0))})},t}(egret.Sprite);egret.registerClass(RacetrackPanel,"RacetrackPanel",["IBase"]);var ResultView=function(e){function t(){e.call(this),this.timer=0,this.skinName="ResultViewSkin",this.dataList=new eui.ArrayCollection,this.itemList.itemRenderer=ResultItemRenderer,this.itemList.dataProvider=this.dataList}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){GameDispatcher.addEventListener(BaseEvent.BET_INFO_CHANGE,this.onInfo,this),ConnectionManager.instance.sendHelper.drawMatch()},i.exit=function(){this.removeEventListener(BaseEvent.BET_INFO_CHANGE,this.onInfo,this),TimerManager.instance.clearTimer(this.execute),this.parent&&this.parent.removeChild(this)},i.execute=function(e){this.timeText.text=String(this.timer),this.timer--},i.onInfo=function(){var e=this,t=ClientModel.instance.lastBetInfo;t&&(this.nameText.text=ConfigModel.instance.horseList[t.horseInfoList[0].id-1].name,this.headImage.source=RES.getRes("betHead"+t.horseInfoList[0].id+"_png"),this.timeText.text=String(t.info.leftTime),t.horseInfoList.forEach(function(t){e.dataList.addItem(t)}),this.dataList.refresh(),this.timer=ClientModel.instance.lastBetInfo.info.leftTime,TimerManager.instance.doLoop(1e3,this.execute,this))},t}(BaseComponent);egret.registerClass(ResultView,"ResultView",["IBase"]);var HallView=function(e){function t(){e.call(this),this.skinName="resource/skins/HallViewSkin.exml",this.touchEnabled=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},i.enter=function(e){},i.exit=function(){null!=this.parent&&this.parent.removeChild(this)},i.execute=function(e){},i.onItemTap=function(e){},i.onTap=function(e){switch(e.target){case this.btn1:ClientModel.instance.changeGameState(new GameWorld);break;case this.btn2:ClientModel.instance.changeGameState(new GameWorld)}},t}(BaseComponent);egret.registerClass(HallView,"HallView",["IBase"]);var LoadingUI=function(e){function t(){e.call(this),this.current=0,this.total=0,this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.enter("resource/game_skins/LoadSkin.exml"),this.y=40}__extends(t,e);var n=__define,i=t,s=i.prototype;return s.createChildren=function(){e.prototype.createChildren.call(this)},s.onSkinComplete=function(e){this.skinLoaded=!0,this.onConfigComplete(),this.tempText.text="当前加载进度：\n总进度："},n(t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),s.loadAssets=function(e,t){null!=e&&(this.callBack=e,this.total=t.length,this.assetsList=t),this.load()},s.load=function(){if(t.instance.assetsList.length>0){var e=t.instance.assetsList.shift();RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e),t.instance.current++}else RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.tempText&&(this.tempText.text="资源加载完毕！"),null!=this.callBack&&this.callBack(),this.exit(),ClientModel.instance.onAssetsComplete()},s.onComplete=function(e){t.instance.load(),"config"==e.groupName&&ConfigModel.instance.parse(RES.getRes("game_json"))},s.onError=function(e){console.error("加载资源遇到错误")},s.onResourceProgress=function(e){t.instance.setProgress(e.itemsLoaded,e.itemsTotal)},s.setProgress=function(e,n){null!=t.instance.tempText&&(t.instance.tempText.text="当前加载进度：["+Math.floor(e/n*100)+"/100]\n总进度：["+t.instance.current+"/"+t.instance.total+"]"),t.instance.bar&&(t.instance.bar.value=e,t.instance.bar.maximum=n)},s.onConfigComplete=function(e){null!=this.versionText&&(this.versionText.text="程序版本："+Main.VERSION+"\n配置文件："+ConfigModel.instance.version)},s.changTip=function(e){},s.enter=function(e){this.skinName=e,GameDispatcher.addEventListener(GameEvent.CONFIG_INIT_COMPLETE_EVENT,this.onConfigComplete,this),this.changTip(this),TimerManager.instance.doLoop(2e3,this.changTip,this)},s.exit=function(e){TimerManager.instance.clearTimer(this.changTip),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),GameDispatcher.instance.removeEventListener(GameEvent.CONFIG_INIT_COMPLETE_EVENT,this.onConfigComplete,this),null!=this.parent&&this.parent.removeChild(this)},s.execute=function(e){},t.tipList=["抵制不良游戏，拒绝盗版游戏","注意自我保护，谨防受骗上当","适度游戏益脑，沉迷游戏伤身","合理安排时间，享受健康生活"],t.assets1=["config","loading","labby","alert","top","betView","main","fish1","db"],t}(BaseComponent);egret.registerClass(LoadingUI,"LoadingUI",["IBase"]);var LoginView=function(e){function t(){e.call(this),t.that=this;var n=new egret.Sprite;n.graphics.beginFill(1118465),n.graphics.drawRect(0,0,Main.STAGE_WIDTH,Main.STAGE_HEIGHT),n.width=Main.STAGE_WIDTH,n.height=Main.STAGE_HEIGHT,n.graphics.endFill(),n.touchEnabled=!0,this.addChild(n),this.nameTip=new egret.TextField,this.nameTip.text="用户名：",this.addChild(this.nameTip),this.nameTip.x=100,this.nameTip.y=200,this.nameText=new egret.TextField,this.nameText.type=egret.TextFieldType.INPUT,this.nameText.x=this.nameTip.x+this.nameTip.width,this.nameText.y=this.nameTip.y,this.nameText.width=200,this.nameText.text="#ogtest00"+RandomUtil.randInt(0,9)+RandomUtil.randInt(0,9),this.nameText.border=!0,this.nameText.background=!0,this.nameText.backgroundColor=0,this.addChild(this.nameText);var i=new egret.TextField;i.text="赛马",this.addChild(i),i.size=50,i.x=this.nameTip.x,i.y=this.nameTip.y-100;var s=new egret.TextField;s.text="点击屏幕登陆游戏",s.size=20,s.x=this.nameTip.x,s.y=this.nameTip.y+200,s.textColor=65793,this.addChild(s),egret.Tween.get(n).to({alpha:.1},15e3),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){GameDispatcher.addEventListener(BaseEvent.LOGIN_RESULT_EVENT,this.onLoginResult,this)},i.exit=function(){null!=t.that.parent&&t.that.parent.removeChild(t.that),UserModel.instance.userName=this.nameText.text},i.execute=function(e){},i.onTap=function(){UserModel.instance.userName=this.nameText.text,ConnectionManager.instance.sendHelper.login()},i.onLoginResult=function(){ClientModel.instance.changeGameState(LoadingUI.instance),LoadingUI.instance.loadAssets(function(){ClientModel.instance.changeGameState(new HallView)},LoadingUI.assets1)},t}(egret.Sprite);egret.registerClass(LoginView,"LoginView",["IBase"]);var HistoryItemRenderer=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.skinName="HistoryItemSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(e){},i.dataChanged=function(){var e=this,t=this.data;this.dateText.text=t.id,t.matchInfoList.forEach(function(t){1==t.rank?e["icon"+t.id].visible=!0:e["icon"+t.id].visible=!1})},t}(eui.ItemRenderer);egret.registerClass(HistoryItemRenderer,"HistoryItemRenderer");var HorseBetInfoRenderer=function(e){function t(){e.call(this),this.point=new egret.Point(0,0),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.skinName="resource/renderer/HorseItenSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(e){},i.dataChanged=function(){var e=this.data;null==this.icon&&(this.icon=BitMapUtil.createBitmapByName("betHead"+e.mcName+"_png"),this.addChildAt(this.icon,this.numChildren-1)),this.nameText.text=e.name,this.indexText.text=e.id.toString(),e.math&&(this.numText.text="X"+e.math.rate,this.stateText.text=""+e.math.state,this.betText.text=""+e.math.bet)},i.onTap=function(e){},t}(eui.ItemRenderer);egret.registerClass(HorseBetInfoRenderer,"HorseBetInfoRenderer");var HorseEntity=function(e){function t(){e.call(this),this.currentPhase=0,this.currentX=0,this._content=new egret.Sprite,this._selectArrow=MovieclipUtils.createMc("arrow_png","arrow_json"),this._content.addChild(this._selectArrow),this.showSelect(!1),this._text=new egret.TextField,this._content.addChild(this._text),this.stateMachine=new StateMachine(this),this.getFSM().ChangeState(HorseEnityStateIdel.instance)}__extends(t,e);var n=__define,i=t,s=i.prototype;return s.update=function(){this.getFSM().Update()},s.handleMessage=function(e){},s.getFSM=function(){return this.stateMachine},s.getDisplayObject=function(){return this._content},s.setData=function(e){e instanceof Array,e instanceof HorseVo&&(this._vo=e,this.setMc(this._vo.mcName),this._text.text=e.id+"")},s.changeAnimation=function(e){this.armature&&(dragonBones.WorldClock.clock.remove(this.armature),this._content.removeChild(this.displayObject),this.armature=this.dragonbonesFactory.buildArmature(e),dragonBones.WorldClock.clock.add(this.armature),this.armature.animation.gotoAndPlay(e),this.displayObject=this.armature.display,this._content.addChild(this.displayObject))},s.setMc=function(e){var t=RES.getRes("donghua4_json"),n=RES.getRes("texture4_json"),i=RES.getRes("texture4_png");if(t)this.dragonbonesFactory=new dragonBones.EgretFactory,this.dragonbonesFactory.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),this.dragonbonesFactory.addTextureAtlas(new dragonBones.EgretTextureAtlas(i,n)),this.armature=this.dragonbonesFactory.buildArmature(AnimationType.IDEL),dragonBones.WorldClock.clock.add(this.armature),this.armature.animation.gotoAndPlay(AnimationType.IDEL),this.displayObject=this.armature.display;else{var s,r=RES.getRes("fish"+e+"_json"),a=RES.getRes("fish"+e+"_png"),o=new egret.MovieClipDataFactory(r,a);s=new egret.MovieClip(o.generateMovieClipData()),s.stop(),s.anchorOffsetX=s.width,s.play(-1),s.touchEnabled=!1,this.displayObject=s}this._content.addChild(this.displayObject),this._selectArrow.x=this.displayObject.width+this._selectArrow.width},s.getDataVo=function(e){return this._vo},s.showSelect=function(e){this._selectArrow.visible=e},n(s,"speed",void 0,function(e){this._vo.speed=e}),t}(BaseMovingEntity);egret.registerClass(HorseEntity,"HorseEntity",["IMovingEneity","IBaseGameEntity"]);var ResultItemRenderer=function(e){function t(){e.call(this),this.skinName="ResultItemSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.dataChanged=function(){var e=this.data;this.nameText.text=ConfigModel.instance.horseList[e.id-1].name,this.muText.text=String(e.rate),this.awardText.text="0"},t}(eui.ItemRenderer);egret.registerClass(ResultItemRenderer,"ResultItemRenderer");var RoomBtnItemRenderer=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.onSkinComplete,this),this.skinName="resource/renderer/RoomItenSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(e){},i.dataChanged=function(){this.bgImage.source=this.data.image,this.mc=MovieclipUtils.createMc("lobbyWareMc_png","lobbyWareMc_json"),this.mc.x=40,this.addChildAt(this.mc,0)},t}(eui.ItemRenderer);egret.registerClass(RoomBtnItemRenderer,"RoomBtnItemRenderer");var TopView=function(e){function t(t,n){e.call(this,!1),this.time=0,this.call=t,this.callThis=n,this.skinName="resource/skins/TopViewSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.moneyText.text=String(UserModel.instance.money),this.kjBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onKjTap,this),this.jlBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJlTap,this),this.smBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSmTap,this),this.moreBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMoreTap,this),this.soundBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSoundTap,this)},i.changeTimerState=function(e){this.stateGroup.visible=e,this.timeBg.visible=e},i.onMoreTap=function(){this.moreGroup.visible=this.moreBtn.selected},i.enter=function(e){if(this.skinLoaded)switch(e){case GameState.BET_STAGE:this.time=ClientModel.instance.betTime,this.typeText.text="投注倒计时",this.changeTimerState(!0);break;case GameState.PREPARE_STAGE:this.typeText.text="比赛倒计时",this.time=ClientModel.instance.resultTime,this.changeTimerState(!0);break;case GameState.RUN_STAGE:return this.typeText.text="",this.timerText.text="",void this.changeTimerState(!1);case GameState.RESULT_STAGE:this.typeText.text="距下一场比赛",this.time=ClientModel.instance.nextTime,this.changeTimerState(!1)}this.onMoneyChange(),TimerManager.instance.doLoop(1e3,this.execute,this),GameDispatcher.addEventListener(BaseEvent.USER_MOENY_CHANGE,this.onMoneyChange,this)},i.exit=function(){},i.execute=function(e){this.time>-1?(this.timerText.text=String(this.time),this.time--):(TimerManager.instance.clearTimer(this.execute),this.call&&this.call.apply(this.callThis))},i.onKjTap=function(e){ClientModel.instance.openWindow(HistoryPanel)},i.onJlTap=function(e){ClientModel.instance.openWindow(OpenationCordPanel)},i.onSmTap=function(e){},i.onSoundTap=function(e){},i.onMoneyChange=function(){this.moneyText.text=UserModel.instance.money.toString()},t}(BaseComponent);egret.registerClass(TopView,"TopView",["IBase"]);var Alert=function(e){function t(){e.call(this),this.isShow=!1,this.skinName="resource/game_skins/window/AlertSkin.exml",this.init()}__extends(t,e);var n=(__define,t),i=n.prototype;return i.enter=function(e){0==this.isShow&&(this.isShow=!0,this.info=WindowManager.instance.alertDataList.shift(),null!=this.info?(this.alpha=1,this.contentText.text=this.info.text):(this.isShow=!1,ClientModel.instance.openWindow(null)),this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtn,this),this.returnBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReturnBtn,this))},i.execute=function(e){},i.onShowComplete=function(){this.isShow=!1,WindowManager.instance.alertDataList.length>0?this.enter():ClientModel.instance.openWindow(null)},i.exit=function(e){this.contentText.text="",TimerManager.instance.clearTimer(ClientModel.instance.openWindow),ClientModel.instance.openWindow(null),this.isShow=!1},i.destroy=function(){this.exit()},i.init=function(){this.bg=new egret.Sprite,this.bg.graphics.beginFill(16777215,0),this.bg.graphics.drawRect(0,0,Main.STAGE_WIDTH,Main.STAGE_HEIGHT),this.bg.graphics.endFill(),this.addChildAt(this.bg,0)},i.onOkBtn=function(){this.info&&this.info.okFun&&this.info.okFun(),this.exit()},i.onReturnBtn=function(){this.info&&this.info.canelFun&&this.info.canelFun(),this.exit()},t.SHOW_TIME=2500,t}(BaseComponent);egret.registerClass(Alert,"Alert",["IWindow","IBase"]);var DiceAlert=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/DiceAlertSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){console.log(e),this.contentText.text=e},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(DiceAlert,"DiceAlert",["IBase"]);var HelpPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/HelpPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},i.exit=function(e){null!=this.stage&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.exit,this),ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},i.onTap=function(e){if(e.target instanceof eui.Button)switch(e.target){case this.btn1:break;case this.btn2:break;case this.btn3:break;case this.btn4:break;case this.btn5:break;case this.btn6:break;case this.btn7:}},t}(BaseComponent);egret.registerClass(HelpPanel,"HelpPanel",["IWindow","IBase"]);var HistoryPanel=function(e){function t(){e.call(this),this.dataList=new eui.ArrayCollection,this.skinName="HistoryPanelSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.list.itemRenderer=HistoryItemRenderer},i.enter=function(e){GameDispatcher.addEventListener(BaseEvent.WINDOW_HISTORY,this.onData,this),ConnectionManager.instance.sendHelper.history()},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){this.exit()},i.onData=function(){var e=this;this.dataList.removeAll(),ClientModel.instance.history.forEach(function(t){e.dataList.addItem(t)}),this.list.dataProvider=this.dataList},t}(BaseComponent);egret.registerClass(HistoryPanel,"HistoryPanel",["IWindow","IBase"]);var HitInfoPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/DiceHitInfoPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(HitInfoPanel,"HitInfoPanel",["IWindow","IBase"]);var MailPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/MailPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(MailPanel,"MailPanel",["IWindow","IBase"]);var OpenationCordPanel=function(e){function t(){e.call(this),this.skinName="OperationRecordPanelSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(OpenationCordPanel,"OpenationCordPanel",["IWindow","IBase"]);var OperationPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/SettingPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t)},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(OperationPanel,"OperationPanel",["IWindow","IBase"]);var RankPanel=function(e){function t(){e.call(this),this.skinName="resource/game_skins/window/RankPanelSkin.exml"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.kBtn.selected=!0},i.enter=function(e){},i.exit=function(){ClientModel.instance.openWindow(null)},i.execute=function(e){},i.init=function(){},i.destroy=function(){},t}(BaseComponent);egret.registerClass(RankPanel,"RankPanel",["IWindow","IBase"]);var WindowManager=function(e){function t(){return e.call(this),this.modalAlpha=0,null!=t._instance?void console.warn("不能重复实例化本类WindowManager！"):(this.winList={},void(this._alertDataList=new Array))}__extends(t,e);var n=__define,i=t,s=i.prototype;return n(t,"instance",function(){return t._instance}),s.open=function(e,t){null!=e&&e==Alert?this._alertDataList.push(t):null!=this.currentWin&&this.close(this.currentWin),e!=this.currentWin&&null!=e&&(null==this.winList[e]&&(this.winList[e]=new e),this.addPopUp(this.winList[e],!0),this.winList[e].enter(t),this.currentWin=this.winList[e])},s.close=function(e,t){if(null!=this.winList[e])this.removePopUp(this.winList[e]),this.winList[e].exit();else{var n=this.currentWin;null!=this.currentWin&&this.contains(n)&&(this.removeChild(n),n.exit())}this.currentWin=null,this.exit()},s.enter=function(e){null==this.bg&&(this.bg=new egret.Sprite,this.bg.graphics.beginFill(0,this.modalAlpha),this.bg.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),this.bg.graphics.endFill(),this.bg.width=this.stage.stageWidth,this.bg.height=this.stage.stageHeight,this.addChildAt(this.bg,0),this.bg.touchEnabled=!0)},s.exit=function(e){null!=this.parent&&this.parent.removeChild(this)},s.destroy=function(){this.exit()},s.addPopUp=function(e,t){void 0===t&&(t=!0),e.alpha=0,this.addChild(e),egret.Tween.get(e).to({alpha:1},300)
},s.removePopUp=function(e){this.contains(e)&&this.removeChild(e)},n(s,"alertDataList",function(){return this._alertDataList}),t._instance=new t,t}(egret.Sprite);egret.registerClass(WindowManager,"WindowManager");var AndroidInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){egret.ExternalInterface.call("2N","quit"),console.log("执行了条用外部方法：退出应用")},n.recharge=function(e){},n.scan=function(e){egret.ExternalInterface.call("2N","scan"),console.warn("执行了条用外部方法:扫码")},n.onSocketClose=function(e){ClientModel.instance.openAlert(2)},n.onLoadeBegin=function(e){},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){},n.callfunction=function(e){},n.onInitComplete=function(e){},e}();egret.registerClass(AndroidInterface,"AndroidInterface",["INative"]);var InterfaceManager=function(){function e(){if("web"==egret.Capabilities.runtimeType)return void(this.currentNative=new WebInterface);switch(egret.Capabilities.os){case"iOS":this.currentNative=new IosInterface;break;case"Android":this.currentNative=new AndroidInterface;break;case"Windows PC":case"Mac OS":this.currentNative=new WebInterface;break;case"Windows Phone":this.currentNative=new WebInterface;break;default:this.isWeiXin&&(this.currentNative=new WebInterface)}}var t=__define,n=e,i=n.prototype;return t(i,"isWeiXin",function(){var e=navigator.userAgent.toString(),t=e.match(/MicroMessenger/i);return"MicroMessenger"==t?!0:!1}),t(i,"isMove",function(){switch(egret.Capabilities.os){case"iOS":case"Android":return!0;default:return!1}}),t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i["native"]=function(){return this.currentNative},i.closeApp=function(t){e.instance.currentNative.closeApp(t)},i.recharge=function(t){e.instance.currentNative.recharge(t)},i.scan=function(t){e.instance.currentNative.scan(t)},i.onSocketClose=function(t){e.instance.currentNative.onSocketClose(t)},i.onLoadeBegin=function(t){e.instance.currentNative.onLoadeBegin(t)},i.onLoadeComplete=function(t){e.instance.currentNative.onLoadeComplete(t)},i.onLoadeError=function(t){e.instance.currentNative.onLoadeError(t)},i.callfunction=function(t){e.instance.currentNative.callfunction(t)},i.onInitComplete=function(t){e.instance.currentNative.onInitComplete(t)},e}();egret.registerClass(InterfaceManager,"InterfaceManager");var IosInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){},n.recharge=function(e){},n.scan=function(e){},n.onSocketClose=function(e){},n.onLoadeBegin=function(e){},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){},n.callfunction=function(e){},n.onInitComplete=function(e){},e}();egret.registerClass(IosInterface,"IosInterface",["INative"]);var WebInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){window.open("lua://CloseHelp.lobby.command"),ConnectionManager.instance.isConnected&&ConnectionManager.instance.close()},n.recharge=function(e){window.open("http://newshop.ourgame.com/class.shtml?flag=2&templateID=19&ClassID=21&ClassName=t")},n.scan=function(e){},n.onSocketClose=function(e){ClientModel.instance.openAlert(2)},n.onLoadeBegin=function(e){window.onWebViewShouldStartLoading(e)},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){window.OnDidFailLoading(e)},n.callfunction=function(e){window.open("lua://webview.touch"+e),ClientModel.instance.openAlert("lua://webview.touch"+e)},n.onInitComplete=function(e){window.location.href="lua://webview.miniGameInitComplete"},e}();egret.registerClass(WebInterface,"WebInterface",["INative"]);var WxInterface=function(){function e(){}var t=(__define,e),n=t.prototype;return n.closeApp=function(e){console.log("执行了条用外部方法：退出应用")},n.recharge=function(e){},n.scan=function(e){console.log("执行了条用外部方法:扫码")},n.onSocketClose=function(e){ClientModel.instance.openAlert(2)},n.onLoadeBegin=function(e){},n.onLoadeComplete=function(e){},n.onLoadeError=function(e){},n.callfunction=function(e){},n.onInitComplete=function(e){},e}();egret.registerClass(WxInterface,"WxInterface",["INative"]);var ConnectionManager=function(){function e(){this.connCount=0,this.isActiveClose=!1,this.byteData=new egret.ByteArray;RES.getRes("PokerSlotsMessage_proto");switch(this._sendHelper=new MsgSendHelper(this.message),this._receiveHelper=new MsgReceiveHelper(this.message),e.CONN_TYPE){case 1:this.socket=new HttpService(this._receiveHelper.onMessage,this);break;case 2:this.socket=new WebSocketHandler(this._receiveHelper.onMessage,this);break;case 3:this.socket=new SocketIoHandler(this._receiveHelper.onMessage,this);break;case 4:this.socket=new HttpHandler(this._receiveHelper.onMessage,this)}}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==this._instance&&(this._instance=new e),this._instance}),i.send=function(e,t){this.socket.send(e,t)},i.initData=function(e,t){this.ip=e,this.port=t,this.conn()},i.conn=function(){e._instance.socket.conn(e._instance.ip,e._instance.port)},i.onClose=function(e){InterfaceManager.instance.onSocketClose(e)},i.close=function(e){this.socket.close()},t(i,"isConnected",function(){return this.socket.isConnected()}),t(i,"sendHelper",function(){return this._sendHelper}),t(i,"receiveHelper",function(){return this._receiveHelper}),i.onConnSuccess=function(){e.instance.sendHelper.login()},i.autoConnction=function(){TimerManager.instance.doOnce(e.CONN_INTERVAL*Math.pow(2,e.instance.connCount),e.instance.conn),e.instance.connCount++,console.log("自动重连，第"+e.instance.connCount+"次，	"+TimeUtils.formatDate(TimeUtils.timestampDate()))},e.CONN_TYPE=4,e.CONN_INTERVAL=2e3,e}();egret.registerClass(ConnectionManager,"ConnectionManager");var HttpHandler=function(){function e(e,t){this.callback=e}var t=(__define,e),n=t.prototype;return n.conn=function(e,t){var n=this,i=new egret.URLLoader;i.dataFormat=egret.URLLoaderDataFormat.TEXT,i.addEventListener(egret.Event.COMPLETE,function(e){e.currentTarget;n.test()},this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this);var s="http://172.28.160.175/login/"+UserModel.instance.token,r=new egret.URLRequest(s);r.method=egret.URLRequestMethod.POST,i.load(r)},n.test=function(){var e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXT,e.addEventListener(egret.Event.COMPLETE,function(e){var t=e.currentTarget;console.log(t)},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this);var t="http://172.28.160.175/login/session",n=new egret.URLRequest(t);n.method=egret.URLRequestMethod.POST,e.load(n)},n.send=function(e,t){var n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.TEXT,n.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this);var i=ConfigModel.instance.url+e,s=new egret.URLRequest(i);s.method=egret.URLRequestMethod.POST,n.load(s)},n.isConnected=function(){return!0},n.close=function(){},n.onGetComplete=function(e){var t,n=e.currentTarget,i=JSON.parse(n.data),s=n._request.url.substr(n._request.url.indexOf("hrb/")+4);t=s.indexOf("/")>-1?s.substring(0,s.lastIndexOf("/")):s,this.callback(t,i),ConfigModel.instance.debug&&console.log(i)},n.onGetIOError=function(e){console.log("get error : "+e.type+"\n url:"+e.currentTarget._url)},n.onGetProgress=function(e){console.log("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e}();egret.registerClass(HttpHandler,"HttpHandler",["ISocket"]);var SocketIoHandler=function(){function e(e,t){this.callback=e,this.manager=t}var t=(__define,e),n=t.prototype;return n.conn=function(e,t){console.log("配置文件中服务器ip与端口："+e+":"+t),this.socket=io.connect("ws://172.28.26.138:7777/websocket"),this.init()},n.send=function(e,t){this.socket.emit("message",t)},n.init=function(){this.socket.on("news",this.newMessage)},n.newMessage=function(e){console.log(e)},n.isConnected=function(){return!0},n.close=function(){},e}();egret.registerClass(SocketIoHandler,"SocketIoHandler",["ISocket"]);var WebSocketHandler=function(){function e(e,t){this.callback=e,this.manager=t,this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)}var t=(__define,e),n=t.prototype;return n.conn=function(e,t){console.log("配置文件中服务器ip与端口："+e),this.socket.connectByUrl(e)},n.send=function(e,t){var n=new egret.ByteArray;n.writeInt(e),n.writeInt(t.byteLength),n.writeInt(0),n.writeBytes(new egret.ByteArray(t)),n.position=0,this.socket.writeBytes(n,0,n.bytesAvailable),this.socket.flush()},n.onReceiveMessage=function(e){var t=new egret.ByteArray;if(this.socket.readBytes(t),t.bytesAvailable>0){if(null!=this.callback){var n=t.readInt(),i=t.readInt(),s=(t.readInt(),new egret.ByteArray);s.writeBytes(t,t.position,i),s.position=0,this.callback(n,s)}}else console.error("非法消息。可用字节："+t.bytesAvailable+"/长度："+t.length+"/指针位置："+t.position)},n.onSocketOpen=function(e){console.log("onSocketOpen"),0==ConfigModel.instance.isShowLogin&&(ClientModel.instance.onConn(),ConnectionManager.instance.onConnSuccess());var t=new egret.ByteArray;ConfigModel.instance.debug&&(t.writeUTF("172.28.14.209"),t.writeInt(7777),t.writeBoolean(!0),this.socket.writeBytes(t,0,t.bytesAvailable),this.socket.flush())},n.onSocketClose=function(e){console.warn("onSocketClose"),this.manager.onClose("onSocketClose"),0==ConnectionManager.instance.isActiveClose&&ConnectionManager.instance.autoConnction()},n.onSocketError=function(e){console.error("onSocketError"),this.manager.onClose("onSocketError")},n.isConnected=function(){return this.socket.connected},n.close=function(){this.socket.close()},e}();egret.registerClass(WebSocketHandler,"WebSocketHandler",["ISocket"]);var BaseMessage=function(){function e(){}var t=(__define,e),n=t.prototype;return n.read=function(e){},e}();egret.registerClass(BaseMessage,"BaseMessage");var MsgLoginReq=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(BaseMessage);egret.registerClass(MsgLoginReq,"MsgLoginReq");var MsgReceiveHelper=function(){function e(t){e.instance=this,this._message=t,this.userModel=UserModel.instance,this.clientModel=ClientModel.instance}var t=__define,n=e,i=n.prototype;return t(i,"msg",function(){return this._message}),i.sender=function(e){this._sender=e},i.onMessage=function(t,n){var i,s=e.instance.msg;if(0==n.rtnCode)switch(t){case 1:i=s.build("DuxLiveTick");var r=i.decode(n.buffer);parseInt(r.time);break;case MsgType.GLFS_PeriodChangeACK:break;case MsgType.A_DICE_INFO:break;case"login":0==n.rtnCode?(GameDispatcher.send(BaseEvent.LOGIN_RESULT_EVENT),ConnectionManager.instance.sendHelper.gameInfo()):ClientModel.instance.openAlert("登陆失败，请重试");break;case"init":ClientModel.instance.gameInfo=n;break;case"draw":ClientModel.instance.setBetInfo(n.drawId,n);break;case"drawResult":ClientModel.instance.setHistory(n)}else ClientModel.instance.openAlert(n.rtnMsg+"(ERROR CDOE:"+n.rtnCode+")"),console.log(n)},e}();egret.registerClass(MsgReceiveHelper,"MsgReceiveHelper");var MsgSendHelper=function(){function e(t){this.clientModel=ClientModel.instance,this.userModel=UserModel.instance,e.instance=this,this._message=t}var t=__define,n=e,i=n.prototype;return i.sender=function(e){this._sender=e},t(i,"msg",function(){return this._message}),i.login=function(){},i.gameInfo=function(){ConnectionManager.instance.send("/hrb/init")},i.drawMatch=function(e){ConnectionManager.instance.send("/hrb/draw")},i.history=function(e){ConnectionManager.instance.send("/hrb/drawResult")},e}();egret.registerClass(MsgSendHelper,"MsgSendHelper");var MsgType=function(){function e(){}var t=(__define,e);t.prototype;return e.GLID_BASE_FISH=1044480,e.REQ_BASE=0,e.ACK_BASE=10,e.GLFS_NetworkEvent=e.GLID_BASE_FISH+1,e.GLFS_Ping=e.GLID_BASE_FISH+513,e.GLFS_PeriodChangeACK=e.GLID_BASE_FISH+514,e.GLFS_PeriodSync=e.GLID_BASE_FISH+515,e.GLFS_PlayerJoinACK=e.GLID_BASE_FISH+516,e.GLFS_PlayerLeaveACK=e.GLID_BASE_FISH+517,e.GLFS_PurchaseBulletTipACK=e.GLID_BASE_FISH+518,e.GLFS_PurchaseBulletREQ=e.GLID_BASE_FISH+519,e.GLFS_PurchaseBulletACK=e.GLID_BASE_FISH+520,e.GLFS_StandardModeSelectREQ=e.GLID_BASE_FISH+521,e.GLFS_PeriodLeaveTimeACK=e.GLID_BASE_FISH+521,e.GLFS_StandardModeSelectACK=e.GLID_BASE_FISH+528,e.GLFS_ShowStageAwards=e.GLID_BASE_FISH+529,e.GLFS_GameResult=e.GLID_BASE_FISH+530,e.GLFS_Checkout=e.GLID_BASE_FISH+531,e.GLFS_RestartACK=e.GLID_BASE_FISH+532,e.GLFS_RestartGameREQ=e.GLID_BASE_FISH+533,e.GLFS_ModeSelectACK=e.GLID_BASE_FISH+534,e.GLFS_TimeReport=e.GLID_BASE_FISH+535,e.GLFS_GameInit=e.GLID_BASE_FISH+536,e.GLFS_NoMoneyACK=e.GLID_BASE_FISH+537,e.GLFS_MGPlayerStateACK=e.GLID_BASE_FISH+544,e.GLFS_MGChangeHostACK=e.GLID_BASE_FISH+545,e.GLFS_MGKickACK=e.GLID_BASE_FISH+546,e.GLFS_MGStartGameREQ=e.GLID_BASE_FISH+547,e.GLFS_MGStateChanged=e.GLID_BASE_FISH+548,e.GLFS_MGGameResult=e.GLID_BASE_FISH+560,e.GLFS_BombAttributeACK=e.GLID_BASE_FISH+576,e.GLFS_BeanLimitACK=e.GLID_BASE_FISH+577,e.GLFS_UpdateBeanACK=e.GLID_BASE_FISH+578,e.GLFS_MaxLossACK=e.GLID_BASE_FISH+582,e.GLFS_NotPurchaseBulletREQ=e.GLID_BASE_FISH+613,e.GLFS_UpdateBeanREQ=e.GLID_BASE_FISH+581,e.GLFS_FreeRechargeTipACK=e.GLID_BASE_FISH+584,e.GLFS_FreeRechargeCommitACK=e.GLID_BASE_FISH+585,e.GLFS_QueryBeanREQ=e.GLID_BASE_FISH+592,e.GLFS_QueryBeanACK=e.GLID_BASE_FISH+593,e.FreeRechargeREQ=e.GLID_BASE_FISH+594,e.GLFS_WallowTimeBoxACK=e.GLID_BASE_FISH+595,e.GLFS_CoinFromRecoverBulletACK=e.GLID_BASE_FISH+614,e.GLFS_FisherUpLevelACK=e.GLID_BASE_FISH+612,e.GLFS_AllServiceBroadcast=e.GLID_BASE_FISH+608,e.GLFS_FisherUpLevelREQ=e.GLID_BASE_FISH+611,e.GLFS_ChangeLevelACK=e.GLID_BASE_FISH+769,e.GLFS_ShootREQ=e.GLID_BASE_FISH+772,e.GLFS_ShootACK=e.GLID_BASE_FISH+773,e.GLFS_ExplodeREQ=e.GLID_BASE_FISH+770,e.GLFS_ExplodeACK=e.GLID_BASE_FISH+771,e.GLFS_CanonRotationACK=e.GLID_BASE_FISH+774,e.GLFS_AutoShootACK=e.GLID_BASE_FISH+775,e.GLFS_ShellGameStartACK=e.GLID_BASE_FISH+1025,e.GLFS_ShellGameSelectACK=e.GLID_BASE_FISH+1026,e.GLFS_DiamondGameStartACK=e.GLID_BASE_FISH+1027,e.GLFS_DiamondGameResultACK=e.GLID_BASE_FISH+1028,e.GLFS_AddDiamondACK=e.GLID_BASE_FISH+1029,e.GLFS_DiamondGameProgressACK=e.GLID_BASE_FISH+1030,e.GLFS_SuperCannonReadyACK=e.GLID_BASE_FISH+1031,e.GLFS_ShellRefreshCoinACK=e.GLID_BASE_FISH+1032,e.GLFS_FishLotteryACK=e.GLID_BASE_FISH+1033,e.GLFS_FullScreenCannonReadyACK=e.GLID_BASE_FISH+1040,e.GLFS_RefreshDiamondTriggerNum=e.GLID_BASE_FISH+1042,e.GLFS_AngryOfGodReadyACK=e.GLID_BASE_FISH+1043,e.GLFS_StartBingoAck=e.GLID_BASE_FISH+1044,e.GLFS_BingoDataReq=e.GLID_BASE_FISH+1045,e.GLFS_BingoDataAck=e.GLID_BASE_FISH+1046,e.GLFS_BingoEndReq=e.GLID_BASE_FISH+1047,e.GLFS_BingoEndAck=e.GLID_BASE_FISH+1048,e.GLFS_DiamondRefreshCoinACK=e.GLID_BASE_FISH+1049,e.GLFS_UseSuperWeaponsReq=e.GLID_BASE_FISH+1056,e.GLFS_RewardTaskStartAck=e.GLID_BASE_FISH+1057,e.GLFS_RewardTaskEndAck=e.GLID_BASE_FISH+1058,e.GLFS_ShellGameOverTimeResultACK=e.GLID_BASE_FISH+1059,e.GLFS_UserBackpackReq=e.GLID_BASE_FISH+1072,e.GLFS_UserBackpackAck=e.GLID_BASE_FISH+1073,e.GLFS_UsePropReq=e.GLID_BASE_FISH+1075,e.GLFS_UsePropAck=e.GLID_BASE_FISH+1076,e.GLFS_TidyBackpackReq=e.GLID_BASE_FISH+1077,e.GLFS_TidyBackpackAck=e.GLID_BASE_FISH+1078,e.GLFS_UnLoadPropReq=e.GLID_BASE_FISH+1079,e.GLFS_UnLoadPropAck=e.GLID_BASE_FISH+1080,e.GLFS_UpdateUserBackpack=e.GLID_BASE_FISH+1081,e.GLFS_RouletteBegin=e.GLID_BASE_FISH+595,e.GLFS_RouletteEnd=e.GLID_BASE_FISH+596,e.GLFS_RouletteAward=e.GLID_BASE_FISH+598,e.GLFS_DebugServerPos=e.GLID_BASE_FISH+2049,e.GLFS_DebugCommandREQ=e.GLID_BASE_FISH+2050,e.GLFS_BombPowerTest=e.GLID_BASE_FISH+2051,e.GLFS_DebugConfigACK=e.GLID_BASE_FISH+2052,e.GLFS_UpdateDebugPanelREQ=e.GLID_BASE_FISH+2053,e.GLFS_UpdateDebugPanelACK=e.GLID_BASE_FISH+2054,e.GLFS_CommitDebugPanelACK=e.GLID_BASE_FISH+2055,e.GLFS_GameBalanceSearchReq=e.GLID_BASE_FISH+2308,e.GLFS_GameBalanceREQ=e.GLID_BASE_FISH+2309,e.GLFS_GameBalanceACK=e.GLID_BASE_FISH+2310,e.GLFS_DailyCheckoutREQ=e.GLID_BASE_FISH+2311,e.GLFS_DailyCheckoutACK=e.GLID_BASE_FISH+2312,e.GLFS_HonorRankREQ=e.GLID_BASE_FISH+2324,e.GLFS_HonorRankACK=e.GLID_BASE_FISH+2325,e.GLFS_MailHeaderREQ=e.GLID_BASE_FISH+2328,e.GLFS_MailHeaderACK=e.GLID_BASE_FISH+2329,e.GLFS_MailContentREQ=e.GLID_BASE_FISH+2330,e.GLFS_MailContentACK=e.GLID_BASE_FISH+2331,e.GLFS_MailDeleteREQ=e.GLID_BASE_FISH+2332,e.GLFS_MailDeleteACK=e.GLID_BASE_FISH+2333,e.GLFS_MailAddReq=e.GLID_BASE_FISH+2334,e.GLFS_MailAddAck=e.GLID_BASE_FISH+2335,e.GLFS_ClearCustomData=e.GLID_BASE_FISH+2336,e.GLFS_UnreadMailACK=e.GLID_BASE_FISH+2337,e.GLFS_RaceGameStartACK=e.GLID_BASE_FISH+1032,e.GLFS_RaceGameBetREQ=e.GLID_BASE_FISH+1033,e.GLFS_RaceGameBetACK=e.GLID_BASE_FISH+1040,e.GLFS_RaceGameBetOver=e.GLID_BASE_FISH+1041,e.GLFS_RaceGameBetResult=e.GLID_BASE_FISH+1042,e.GLFS_RaceGameSeedACK=e.GLID_BASE_FISH+1048,e.GLFS_SharkGameStartACK=e.GLID_BASE_FISH+1043,e.GLFS_SharkGameResultACK=e.GLID_BASE_FISH+1044,e.GLFS_SharkGameProgressACK=e.GLID_BASE_FISH+1045,e.GLFS_ShoalFishStartACK=e.GLID_BASE_FISH+1046,e.GLFS_SharkGamePhaseTimeACK=e.GLID_BASE_FISH+1047,e.GLFS_SharkGameSendBadgeACK=e.GLID_BASE_FISH+1056,e.GLFS_SharkGameCostChampionACK=e.GLID_BASE_FISH+1057,e.GLFS_ChatNotifyMessage=e.GLID_BASE_FISH+625,e.GLFS_UserCheckOutACK=e.GLID_BASE_FISH+642,e.GLFS_UserCheckOutREQ=e.GLID_BASE_FISH+641,e.GLFS_KeepOnGameREQ=e.GLID_BASE_FISH+643,e.GLFS_KeepOnGameACK=e.GLID_BASE_FISH+644,e.GLFS_NotifyMessage=e.GLID_BASE_FISH+599,e.GLFS_RequestCheckAchievement=e.GLID_BASE_FISH+1281,e.GLFS_CommonLockFishReq=e.GLID_BASE_FISH+2405,e.GLFS_CommonLockFishAck=e.GLID_BASE_FISH+2406,e.GLFS_CommonLockInstanceReq=e.GLID_BASE_FISH+2407,e.GLFS_CommonLockInstanceAck=e.GLID_BASE_FISH+2408,e.GLFS_CheckBuyBulletREQ=e.GLID_BASE_FISH+599,e.GLFS_BettingValueForBombACK=e.GLID_BASE_FISH+2402,e.GLFS_DoubleTimesForFishACK=e.GLID_BASE_FISH+2403,e.GLFS_ScorePromptACK=e.GLID_BASE_FISH+2404,e.GLFS_SpecialTimesFishConfigAck=e.GLID_BASE_FISH+1063,e.GLFS_NoviceGuideTaskProcessAck=e.GLID_BASE_FISH+1060,e.GLFS_UpdateUserAchievementArrayReq=e.GLID_BASE_FISH+1061,e.GLFS_QuoridorMailNoticeReq=e.GLID_BASE_FISH+1062,e.GLFS_RefreshHandselPrizePoolAck=e.GLID_BASE_FISH+2437,e.GLFS_HandselGameResultAck=e.GLID_BASE_FISH+2438,e.GLFS_UserHandselInfosRankReq=e.GLID_BASE_FISH+2439,e.GLFS_UserHandselInfosRankAck=e.GLID_BASE_FISH+2440,e.GLFS_OurGameInnerGameMarkReq=e.GLID_BASE_FISH+2579,e.GLFS_NoTrialBulletACK=e.GLID_BASE_FISH+1064,e.GLFS_AddSbsStarACK=e.GLID_BASE_FISH+1065,e.GLFS_AddSbsLeftTimesACK=e.GLID_BASE_FISH+1066,e.GLFS_QueryAllSbsGameConfAck=e.GLID_BASE_FISH+2453,e.GLFS_QueryCurNOPACK=e.GLID_BASE_FISH+2456,e.GLFS_SGBroadCastACK=e.GLID_BASE_FISH+2459,e.GLFS_FishIslandRegistMailOBReq=e.GLID_BASE_FISH+2466,e.GLFS_FishIslandRegistMailOBAck=e.GLID_BASE_FISH+2467,e.R_LOGIN=e.REQ_BASE+1,e.A_LOGIN=e.ACK_BASE+1,e.R_DICE_INFO=e.REQ_BASE+10,e.A_DICE_INFO=e.ACK_BASE+10,e.A_GAME_POOL=e.REQ_BASE+100,e}();egret.registerClass(MsgType,"MsgType");var HttpService=function(){function e(e,t){var n=this;this.globalTime=0,this.call=e,this.callThis=t,ConfigModel.instance.debug&&RES.getResAsync("tempContent_json",function(e){n.data=e},this),TimerManager.instance.doLoop(1e3,this.onTimer,this)}var t=(__define,e),n=t.prototype;return n.onTimer=function(){this.globalTime>60&&(this.globalTime=0),this.globalTime++},n.conn=function(e,t){},n.send=function(e,t){switch(e){default:var n=e;e.lastIndexOf("/")>-1&&(n=e.substr(n.lastIndexOf("/")+1));var i=this.data[e];i.cdTime&&(i.cdTime=1e3*(30-this.globalTime)),i.leftTime&&(i.leftTime=1e3*(60-this.globalTime)),this.call.apply(this.callThis,[n,i])}},n.isConnected=function(){return!0},n.close=function(){},e}();egret.registerClass(HttpService,"HttpService",["ISocket"]);var LocalHandler=function(){function e(t){this.userMoney=888999777,this.baseAnte=0,this.batTimes=0,this.pool=9589000001,this.awardMoney=0,this.name="",e.that=this,this.callback=t,this.initInfo()}var t=(__define,e),n=t.prototype;return n.initInfo=function(){},n.isConnected=function(){return!0},n.close=function(){},n.send=function(e,t){var n;switch(e){case MsgType.GLFS_AddSbsLeftTimesACK:n=this.login;break;case MsgType.GLFS_Ping:break;case MsgType.R_DICE_INFO:break;case MsgType.R_LOGIN:n=this.login}n.apply(this,[e,t])},n.conn=function(e,t){},n.returnMsg=function(t,n){if(null!=e.that.callback){var i=new egret.ByteArray;i.buffer=n.toArrayBuffer(),e.that.callback(t,i)}},n.returnMsg2=function(t,n){null!=e.that.callback&&e.that.callback(t,n)},n.login=function(e,t){this.name=t.name,this.returnMsg2(MsgType.A_LOGIN,{success:0}),this.jpPool(),TimerManager.instance.doLoop(1500,this.jpPool,this)},n.jpPool=function(){this.pool+=RandomUtil.randInt(5,99),this.returnMsg2(MsgType.A_GAME_POOL,{value:this.pool})},e.MAX_CARDS=5,e}();egret.registerClass(LocalHandler,"LocalHandler",["ISocket"]);var BitMapUtil=function(){function e(){}var t=(__define,e);t.prototype;return e.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},e}();egret.registerClass(BitMapUtil,"BitMapUtil");var MovieclipUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.createMc=function(e,t,n){var i,s=RES.getRes(t),r=RES.getRes(e),a=new egret.MovieClipDataFactory(s,r);return i=new egret.MovieClip(a.generateMovieClipData(n)),i.stop(),i.play(-1),i.touchEnabled=!1,i},e.getFactory=function(e,t){var n=RES.getRes(t),i=RES.getRes(e),s=new egret.MovieClipDataFactory(n,i);return s},e}();egret.registerClass(MovieclipUtils,"MovieclipUtils");var ButtonUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.simulateClick=function(e){null!=e&&(e.currentState="down")},e}();egret.registerClass(ButtonUtils,"ButtonUtils");var HitTestUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.hitTest=function(e,t,n){void 0===n&&(n=!1);var i=e.getBounds(),s=t.getBounds(),r=!1;return i.x=e.x-e.anchorOffsetX,i.y=e.y-e.anchorOffsetY,s.x=t.x,s.y=t.y,egret.Rectangle.release(i),egret.Rectangle.release(s),t.parent&&(t.parent.graphics.clear(),t.parent.graphics.beginFill(0,.5),t.parent.graphics.drawRect(s.x,s.y,s.width,s.height),t.parent.graphics.endFill()),e.parent&&(t.parent.graphics.clear(),t.parent.graphics.beginFill(0,.5),t.parent.graphics.drawRect(i.x,i.y,i.width,i.height),t.parent.graphics.endFill()),r=i.intersects(s),n?void 0:r},e.hitTestByRec=function(e,t){return e.intersects(t)},e}();egret.registerClass(HitTestUtils,"HitTestUtils");var MatrixUtils=function(){function e(){}var t=__define,n=e;n.prototype;return t(e,"blurFliter",function(){return new egret.BlurFilter(1,1)}),e.colorMatrix=[1,0,0,0,100,0,1,0,0,100,0,0,1,0,100,0,0,0,1,0],e.greenx2=[1,0,0,0,0,0,2,0,0,0,0,0,1,0,0,0,0,0,1,0],e.red=[5,5,5,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],e.blue=[1,0,0,0,0,0,1,0,0,0,.5,.5,1,0,0,0,0,0,1,0],e.change=[1,0,0,0,0,0,1,0,0,0,0,0,2,0,0,0,0,0,1,0],e}();egret.registerClass(MatrixUtils,"MatrixUtils");var PcKeyBoardHelper=function(){function e(){this.isListening=!1,this.list={}}var t=__define,n=e,i=n.prototype;return t(e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),i.add=function(){0==this.isListening&&(this.isListening=!0,document.addEventListener("keydown",e.instance.onKeyDown))},i.onKeyDown=function(t){var n;for(n in e.instance.list){var i=e.instance.list[n];i.callback.call(i.target,t)}},i.addListener=function(t,n){var i=egret.getQualifiedClassName(n);if(null==e._instance.list[i]){var s=new KeyVo(i,n,t);e._instance.list[s.name]=s}e._instance.add()},i.removeListener=function(t){var n=egret.getQualifiedClassName(t);null!=e._instance.list[n]&&delete e._instance.list[n],this.checkCount()},i.checkCount=function(){for(var t in e._instance.list)return;document.removeEventListener("keydown",e.instance.onKeyDown),this.isListening=!1},e}();egret.registerClass(PcKeyBoardHelper,"PcKeyBoardHelper");var KeyVo=function(){function e(e,t,n){this.name="",this.name=e,this.target=t,this.callback=n}var t=(__define,e);t.prototype;return e}();egret.registerClass(KeyVo,"KeyVo");var PcMouseHelper=function(){function e(){this.isListening=!1,this.list=new Array}var t=__define,n=e,i=n.prototype;return i.add=function(){0==this.isListening&&(this.isListening=!0,this.canvas=document.getElementsByTagName("CANVAS")[0],this.canvas.addEventListener("mousemove",this.onMove))},i.addListener=function(e){this.add(),this.list.push(e)},i.removeListener=function(t){e._instance.list.indexOf(t)>-1&&(e._instance.list.splice(e._instance.list.indexOf(t),1),this.checkCount())},i.checkCount=function(){for(var t in e._instance.list)return;e._instance.canvas.style.cursor="auto",this.canvas.removeEventListener("mousemove",this.onMove),this.isListening=!1},i.onMove=function(t){for(var n=e._instance.list.length,i=e._instance.getPoint(t.currentTarget,t.x,t.y),s=0;n>s;s++){if(e._instance.list[s].hitTestPoint(i.x,i.y))return void(e._instance.canvas.style.cursor="pointer")}e._instance.canvas.style.cursor="auto"},i.getPoint=function(e,t,n){var i=window.getComputedStyle(e,null),s=e.getBoundingClientRect();return{x:(t-s.left)*(e.width/parseFloat(i.width)),y:(n-s.top)*(e.height/parseFloat(i.height))}},t(e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e}();egret.registerClass(PcMouseHelper,"PcMouseHelper");var RandomUtil=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t.randNumber=function(e,t){return e+Math.random()*(t-e)},t.randInt=function(e,t){return e+Math.round(Math.random()*(t-e))},t.randColor=function(){return 6710886*Math.random()},t.randPt=function(e,t,n,i){return new egret.Point(e+Math.random()*(n-e),t+Math.random()*(i-t))},t}(egret.HashObject);egret.registerClass(RandomUtil,"RandomUtil");var RollNumber=function(){function e(e,t,n,i){this.speed=2,this.myArray=0,this.isDecimal=i,this.callBackFun=e,this.myArray=0,this.speed=n?n:2,this.target=t}var t=(__define,e),n=t.prototype;return n.setSpeed=function(e){this.speed=e},n.setNumber=function(e){TweenLite.to(this,this.speed,{myArray:e,onUpdate:this.updateHandler,onUpdateParams:[this]})},n.getNumber=function(){return this.myArray},n.updateHandler=function(e){e.isDecimal?e.callBackFun(e.myArray):e.callBackFun(Math.round(e.myArray))},e}();egret.registerClass(RollNumber,"RollNumber");var StringUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.cutStr=function(e,t){void 0===e&&(e=""),void 0===t&&(t=6);for(var n="",i=0,s=0;i<e.length&&2*t>s;)e.charCodeAt(i)>192?s+=2:s++,n+=e.charAt(i),i++;return n.length<e.length&&(n+="..."),n},e.numSection=function(e){void 0===e&&(e=0);for(var t=e.toString(),n="",i=0;i<t.length;i++)(t.length-i)%3==0&&0!=i&&(n+=","),n+=t.charAt(i);return n},e.getStrByUnits=function(e){if(0>=e)return"0";var t=e/1e8,n=e%1e8/1e4,i=e%1e4,s="";return 0!=t&&(s=s+t+"亿"),0!=n&&(s=s+n+"万"),0==t&&0!=i&&(s+=i),s},e.randomChinese=function(){return String.fromCharCode(Math.floor(16384*Math.random())+20480)},e}();egret.registerClass(StringUtils,"StringUtils");var TimerManager=function(){function e(){this._shape=new egret.Shape,this._pool=new Array,this._handlers=new Object,this._currTimer=egret.getTimer(),this._currFrame=0,this._count=0,this._index=0,this._shape.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)}var t=__define,n=e,i=n.prototype;return i.onEnterFrame=function(e){this._currFrame++,this._currTimer=egret.getTimer();var t;for(t in this._handlers)if("undefined"!=t){var n=this._handlers[t],i=n.userFrame?this._currFrame:this._currTimer;if(i>=n.exeTime){var s=n.method,r=n.args;if(n.repeat)for(;i>=n.exeTime&&t in this._handlers;)n.exeTime+=n.delay,s.apply(n.thisObj,r);else s.apply(n.thisObj,r),this.clearTimer(t)}}else console.log(t)},i.create=function(e,t,n,i,s,r,a){void 0===s&&(s=null),void 0===r&&(r=null),void 0===a&&(a=!0);var o;if(a?(this.clearTimer(i),o=i):o=this._index++,1>n)return i.apply(null,r),-1;var c=this._pool.length>0?this._pool.pop():new TimerHandler;return c.userFrame=e,c.repeat=t,c.delay=n,c.method=i,c.thisObj=s,c.args=r,c.exeTime=n+(e?this._currFrame:this._currTimer),this._handlers[o]=c,this._count++,o},i.doOnce=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!1,!1,e,t,n,i,s)},i.doLoop=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!1,!0,e,t,n,i,s)},i.doFrameOnce=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!0,!1,e,t,n,i,s)},i.doFrameLoop=function(e,t,n,i,s){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=!0),this.create(!0,!0,e,t,n,i,s)},t(i,"count",function(){return this._count}),i.clearTimer=function(e){var t=this._handlers[e];null!=t&&(delete this._handlers[e],t.clear(),this._pool.push(t),this._count--)},i.destroy=function(){this._shape.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},i.running=function(e){return null!=this._handlers[e]?!0:!1},i.clearTimerByFun=function(e){this.clearTimer(e)},t(e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e}();egret.registerClass(TimerManager,"TimerManager");var TimerHandler=function(){function e(){this.delay=0,this.exeTime=0}var t=(__define,e),n=t.prototype;return n.clear=function(){this.method=null,this.args=null,this.thisObj=null},e}();egret.registerClass(TimerHandler,"TimerHandler");var TimeUtils=function(){function e(){}var t=(__define,e);t.prototype;return e.timestampDate=function(){return Math.round((new Date).getTime()/1e3)},e.formatDate=function(e){var t,n,i,s=new Date(1e3*parseInt(e)).toLocaleTimeString().replace("上午","").replace("下午","").replace(":","").replace(":",""),r=new Date(1e3*parseInt(e)).toLocaleTimeString().replace("上午","").replace("下午",""),a=new Date(1e3*parseInt(e)).toLocaleTimeString(),o=a.substr(0,1),c=s,h=s,l=s,u=new Date(1e3*parseInt(e)).toLocaleDateString().replace(/\//gi,"-");if("下"==o){for(var d=0;4>d;d++)c=c.substring(0,c.length-1);if(Number(c)>=1&&Number(c)<=9){h=h.substring(1);for(var _=0;3>_;_++)l=l.substring(1)}else{for(var g=0;2>g;g++)h=h.substring(1);for(var f=0;4>f;f++)l=l.substring(1)}for(var p=0;2>p;p++)h=h.substring(0,h.length-1);t=12==Number(c)?"12":12+Number(c)}else{for(var d=0;4>d;d++)c=c.substring(0,c.length-1);if(Number(c)>=0&&Number(c)<=9){h=h.substring(1);for(var _=0;3>_;_++)l=l.substring(1)}else{for(var g=0;2>g;g++)h=h.substring(1);for(var f=0;4>f;f++)l=l.substring(1)}for(var p=0;2>p;p++)h=h.substring(0,h.length-1);t=12==Number(c)?"00":Number(c)>=10&&Number(c)<=11?"0"+Number(c):Number(c)}return n=h,i=l,r=u+" "+t+":"+n+":"+i},e}();egret.registerClass(TimeUtils,"TimeUtils");var TestEvent=function(){function e(){}var t=(__define,e);t.prototype;return e.ADD_FISH_EVENT="addFishEvent",e.CHANGE_PATH="changePath",e.CHANGE_MAP="changeMap",e.CLOSE_EVENT="closeEvent",e}();egret.registerClass(TestEvent,"TestEvent");var TestWindow=function(e){function t(){e.call(this,!1),this.skinName="resource/game_skins/TestSkin.exml",this.alpha=.6}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onSkinComplete=function(t){e.prototype.onSkinComplete.call(this,t),this.x=745,this.y=120},i.enter=function(e){this.main=e,this.skinLoaded&&(this.curBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCutBtn,this),this.changeMapBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeMap,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),TimerManager.instance.doLoop(1e3,this.execute,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this))},i.exit=function(){this.onTouchEnd()},i.execute=function(e){this.skinLoaded&&(this.numText.text="生成数:"+EntityManager.instance.length,this.showNumText.text="显示数:"+this.main.game.getChildAt(1).getChildAt(1).numChildren)},i.onTouchEnd=function(e){TimerManager.instance.clearTimer(this.onMove)},i.onTouchMove=function(e){TimerManager.instance.doFrameLoop(1,this.onMove,this,[e])
},i.onMove=function(e){this.x=e.stageX-(this.width>>1),this.y=e.stageY-(this.height>>1)},i.onAddBtn=function(){GameDispatcher.send(TestEvent.ADD_FISH_EVENT)},i.onCutBtn=function(){GameDispatcher.send(TestEvent.CHANGE_PATH)},i.onSBtn=function(){TimerManager.instance.clearTimer(this.onAddBtn)},i.on8Btn=function(){TimerManager.instance.doLoop(150,this.onAddBtn,this)},i.onChangeMap=function(){GameDispatcher.send(TestEvent.CHANGE_MAP)},i.onClose=function(){this.parent&&this.parent.removeChild(this)},t}(BaseComponent);egret.registerClass(TestWindow,"TestWindow",["IBase"]);var ThemeAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getTheme=function(e,t,n,i){function s(e){t.call(i,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);